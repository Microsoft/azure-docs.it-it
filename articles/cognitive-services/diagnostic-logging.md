---
title: Registrazione diagnostica
titleSuffix: Azure Cognitive Services
description: Questa guida fornisce istruzioni dettagliate per abilitare la registrazione diagnostica per un servizio cognitivo di Azure.This guide provides step-by-step instructions to enable diagnostic logging for an Azure Cognitive Service. Questi log forniscono dati frequenti e avanzati sul funzionamento di una risorsa utilizzati per l'identificazione e il debug dei problemi.
services: cognitive-services
author: erhopf
manager: nitinme
ms.service: cognitive-services
ms.topic: article
ms.date: 06/14/2019
ms.author: erhopf
ms.openlocfilehash: 539a35f170b2ee0c94762a30ed9376ca4a416210
ms.sourcegitcommit: 2ec4b3d0bad7dc0071400c2a2264399e4fe34897
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/28/2020
ms.locfileid: "71827905"
---
# <a name="enable-diagnostic-logging-for-azure-cognitive-services"></a>Abilitare la registrazione diagnostica per Servizi cognitivi di AzureEnable diagnostic logging for Azure Cognitive Services

Questa guida fornisce istruzioni dettagliate per abilitare la registrazione diagnostica per un servizio cognitivo di Azure.This guide provides step-by-step instructions to enable diagnostic logging for an Azure Cognitive Service. Questi log forniscono dati frequenti e avanzati sul funzionamento di una risorsa utilizzati per l'identificazione e il debug dei problemi. Prima di continuare, è necessario disporre di un account Azure con una sottoscrizione ad almeno un servizio cognitivo, ad esempio [Ricerca Web Bing](https://docs.microsoft.com/azure/cognitive-services/bing-web-search/overview), Servizi di [riconoscimento vocale](https://docs.microsoft.com/azure/cognitive-services/speech-service/overview)o [LUIS](https://docs.microsoft.com/azure/cognitive-services/luis/what-is-luis).

## <a name="prerequisites"></a>Prerequisiti

Per abilitare la registrazione diagnostica, è necessario un punto in cui archiviare i dati di log. Questa esercitazione usa Archiviazione di Azure e Log Analytics.This tutorial uses Azure Storage and Log Analytics.

* [Archiviazione di Azure:](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-archive-diagnostic-logs) mantiene i log di diagnostica per il controllo dei criteri, l'analisi statica o il backup. L'account di archiviazione non deve trovarsi nella stessa sottoscrizione della risorsa che emette log, purché l'utente che configura l'impostazione abbia un accesso RBAC appropriato a entrambe le sottoscrizioni.
* [Log Analytics:](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitor-stream-diagnostic-logs-log-analytics) strumento flessibile di ricerca e analisi dei log che consente l'analisi dei log non elaborati generati da una risorsa di Azure.Log Analytics - A flexible log search and analytics tool that allows for analysis of raw logs generated by an Azure resource.

> [!NOTE]
> Sono disponibili ulteriori opzioni di configurazione. Per altre informazioni, vedere Raccogliere e usare dati di log dalle risorse di Azure.To learn more, see [Collect and consume log data from your Azure resources.](https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-logs-overview)

## <a name="enable-diagnostic-log-collection"></a>Abilitare la raccolta dei log di diagnosticaEnable diagnostic log collection  

Iniziamo abilitando la registrazione diagnostica usando il portale di Azure.Let's start by enabling diagnostic logging using the Azure portal.

> [!NOTE]
> Per abilitare questa funzionalità usando PowerShell o l'interfaccia della riga di comando di Azure, usare le istruzioni fornite in Raccogliere e usare i dati di log dalle risorse di Azure.To enable this feature using PowerShell or the Azure CLI, use the instructions provided in [Collect and consume log data from your Azure resources.](https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-logs-overview)

1. Passare al portale di Azure. Individuare e selezionare quindi una risorsa di Servizi cognitivi. Ad esempio, la sottoscrizione a Ricerca Web Bing.   
2. Successivamente, dal menu di navigazione a sinistra, individuare **Monitoraggio** e selezionare **Impostazioni di diagnostica**. Questa schermata contiene tutte le impostazioni di diagnostica create in precedenza per questa risorsa.
3. Se è presente una risorsa creata in precedenza che si desidera utilizzare, è possibile selezionarla ora. In caso contrario, selezionare **Aggiungi impostazione diagnostica**.
4. Immettere un nome per l'impostazione. Selezionare quindi **Archivia a un account di archiviazione** e Invia a log **Analytics**.
5. Quando viene richiesto di configurare, selezionare l'account di archiviazione e l'area di lavoro di OMS che si vuole usare per archiviare i log di diagnostica. **Nota:** se non si dispone di un account di archiviazione o di un'area di lavoro OMS, seguire le istruzioni visualizzate per crearne uno.
6. Selezionare **Audit**, **RequestResponse**e **AllMetrics**. Impostare quindi il periodo di conservazione per i dati del log di diagnostica. Se un criterio di conservazione è impostato su zero, gli eventi per tale categoria di log vengono archiviati a tempo indeterminato.
7. Fare clic su **Salva**.

Possono essere take fino a due ore prima che la registrazione dei dati sia disponibile per l'esecuzione di query e l'analisi. Quindi non preoccuparti se non vedi subito niente.

## <a name="view-and-export-diagnostic-data-from-azure-storage"></a>Visualizzare ed esportare i dati di diagnostica da Archiviazione di AzureView and export diagnostic data from Azure Storage

Archiviazione di Azure è una soluzione di archiviazione di oggetti affidabile ottimizzata per l'archiviazione di grandi quantità di dati non strutturati. In questa sezione imparerai a eseguire query sull'account di archiviazione per ottenere transazioni totali in un periodo di tempo di 30 giorni ed esportare i dati in Excel.

1. Dal portale di Azure individuare la risorsa di Archiviazione di Azure creata nell'ultima sezione.
2. Dal menu di navigazione a sinistra, individuare **Monitoraggio** e selezionare **Metriche**.
3. Utilizzare gli a discesa disponibili per configurare la query. Per questo esempio, impostiamo l'intervallo di tempo su **Ultimi 30 giorni** e la metrica su **Transazione**.
4. Al termine della query, verrà visualizzata una visualizzazione della transazione negli ultimi 30 giorni. Per esportare questi dati, utilizzare il pulsante **Esporta in Excel** nella parte superiore della pagina.

Altre informazioni sulle operazioni che è possibile eseguire con i dati di diagnostica in [Archiviazione di Azure](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction).Learn more about what you can do with diagnostic data in Azure Storage .

## <a name="view-logs-in-log-analytics"></a>Visualizzare i log in Log Analytics

Seguire queste istruzioni per esplorare i dati di analisi dei log per la risorsa.

1. Nel portale di Azure individuare e selezionare **Log Analytics** dal menu di spostamento a sinistra.
2. Individuare e selezionare la risorsa creata durante l'abilitazione della diagnostica.
3. In **Generale**, individuare e selezionare **Registri**. Da questa pagina è possibile eseguire query sui log.

### <a name="sample-queries"></a>Query di esempio

Ecco alcune query Kusto di base che puoi usare per esplorare i dati di log.

Eseguire questa query per tutti i log di diagnostica da Servizi cognitivi di Azure per un periodo di tempo specificato:Run this query for all diagnostic logs from Azure Cognitive Services for a specified time period:

```kusto
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.COGNITIVESERVICES"
```

Eseguire questa query per visualizzare i 10 registri più recenti:

```kusto
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.COGNITIVESERVICES"
| take 10
```

Eseguire la query per raggruppare le operazioni in base alla **risorsa**:

```kusto
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.COGNITIVESERVICES" |
summarize count() by Resource
```
Eseguire questa query per trovare il tempo medio necessario per eseguire un'operazione:Run this query to find the average time it takes to perform an operation:

```kusto
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.COGNITIVESERVICES"
| summarize avg(DurationMs)
by OperationName
```

Eseguire questa query per visualizzare il volume delle operazioni suddivise nel tempo per NomeOperazione con i conteggi collocati ogni 10s.

```kusto
AzureDiagnostics
| where ResourceProvider == "MICROSOFT.COGNITIVESERVICES"
| summarize count()
by bin(TimeGenerated, 10s), OperationName
| render areachart kind=unstacked
```

## <a name="next-steps"></a>Passaggi successivi

* Per informazioni su come abilitare la registrazione e anche le metriche e le categorie di log supportate dai vari servizi di Azure, leggere gli articoli [Panoramica delle metriche](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-overview-metrics) in Microsoft Azure e [Panoramica dei log di diagnostica di Azure.To](https://docs.microsoft.com/azure/azure-monitor/platform/diagnostic-logs-overview) understand how to enable logging, and also the metrics and log categories that are supported by the various Azure services, read both the Overview of metrics in Microsoft Azure and Overview of Azure Diagnostic Logs articles.
* Per informazioni sugli hub eventi, leggere gli articoli seguenti:
  * [Che cos'è l'hub di eventi di Azure?](https://docs.microsoft.com/azure/event-hubs/event-hubs-what-is-event-hubs)
  * [Introduzione all'Hub eventi](https://docs.microsoft.com/azure/event-hubs/event-hubs-csharp-ephcs-getstarted)
* Leggere [Scaricare le metriche e i log di diagnostica da Archiviazione di Azure](https://docs.microsoft.com/azure/storage/blobs/storage-quickstart-blobs-dotnet#download-blobs).
* Leggere [Informazioni sulle ricerche di log nei log](https://docs.microsoft.com/azure/log-analytics/log-analytics-log-search-new)di Monitoraggio di Azure .
