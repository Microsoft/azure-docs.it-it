---
title: Informazioni di riferimento-linea di base di configurazione Guest di criteri di Azure per Linux
description: Dettagli della linea di base di Linux in Azure implementata tramite la configurazione Guest di criteri di Azure.
ms.date: 03/12/2021
ms.topic: reference
ms.custom: generated
ms.openlocfilehash: 6b1d3048fdc0945e1ee64e211d2f7b1f9de5e6e6
ms.sourcegitcommit: f28ebb95ae9aaaff3f87d8388a09b41e0b3445b5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/30/2021
ms.locfileid: "103419865"
---
# <a name="azure-policy-guest-configuration-baseline-for-linux"></a>Linea di base di configurazione Guest di criteri di Azure per Linux

L'articolo seguente illustra in dettaglio i **\[ \] requisiti per i computer Linux di anteprima che soddisfano i requisiti per i controlli della definizione dei criteri di configurazione Guest di base della sicurezza di Azure** . Per altre informazioni, vedere [configurazione dei guest di criteri di Azure](../concepts/guest-configuration.md) e [Panoramica del benchmark di sicurezza di Azure (v2)](../../../security/benchmarks/overview.md).

## <a name="general-security-controls"></a>Controlli di sicurezza generali

|Nome<br /><sub>ID</sub> |Dettagli |Verifica monitoraggio e aggiornamento |
|---|---|---|
|Verificare che l'opzione nodev sia impostata su/Home Partition.<br /><sub>1.1.4</sub> |Descrizione: un utente malintenzionato potrebbe montare un dispositivo speciale, ad esempio un blocco o un dispositivo a caratteri, nella partizione/Home. |Modificare il file/etc/fstab e nodev il quarto campo (opzioni di montaggio) per la partizione/Home. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione nodev sia impostata nella partizione tmp.<br /><sub>1.1.5</sub> |Descrizione: un utente malintenzionato potrebbe montare un dispositivo speciale, ad esempio un blocco o un dispositivo a caratteri, nella partizione tmp. |Modificare il file/etc/fstab e nodev il quarto campo (opzioni di montaggio) per la partizione tmp. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione nodev sia impostata sulla partizione/var/tmp.<br /><sub>1.1.6</sub> |Descrizione: un utente malintenzionato potrebbe montare un dispositivo speciale, ad esempio un blocco o un dispositivo a caratteri, sulla partizione/var/tmp. |Modificare il file/etc/fstab e nodev il quarto campo (opzioni di montaggio) per la partizione/var/tmp. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione nosuid sia impostata sulla partizione tmp.<br /><sub>1.1.7</sub> |Descrizione: poiché il file system/tmp è destinato solo all'archiviazione temporanea dei file, impostare questa opzione per assicurarsi che gli utenti non possano creare file setuid in/var/tmp. |Modificare il file/etc/fstab e nosuid il quarto campo (opzioni di montaggio) per la partizione tmp. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione nosuid sia impostata sulla partizione/var/tmp.<br /><sub>1.1.8</sub> |Descrizione: poiché il file System/var/tmp è destinato solo all'archiviazione temporanea dei file, impostare questa opzione per assicurarsi che gli utenti non possano creare file setuid in/var/tmp. |Modificare il file/etc/fstab e nosuid il quarto campo (opzioni di montaggio) per la partizione/var/tmp. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione NOEXEC sia impostata sulla partizione/var/tmp.<br /><sub>1.1.9</sub> |Descrizione: poiché il `/var/tmp` file System è destinato solo all'archiviazione temporanea dei file, impostare questa opzione per assicurarsi che gli utenti non possano eseguire file binari eseguibili da `/var/tmp` . |Modificare il file/etc/fstab e aggiungere noexec al quarto campo (opzioni di montaggio) per la partizione/var/tmp. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Verificare che l'opzione NOEXEC sia impostata sulla partizione/dev/shm.<br /><sub>(1.1.16)</sub> |Descrizione: se si imposta questa opzione su un file system si impedisce agli utenti di eseguire programmi dalla memoria condivisa. Questo impedisce agli utenti di introdurre software potenzialmente dannoso nel sistema. |Modificare il file/etc/fstab e aggiungere noexec al quarto campo (opzioni di montaggio) per la partizione/dev/shm. Per ulteriori informazioni, vedere la pagina relativa alle pagine manuali di fstab (5). |
|Disabilita montaggio automatico<br /><sub>(1.1.21)</sub> |Descrizione: con il montaggio automatico tutti gli utenti con accesso fisico possono connettere un'unità USB o un disco e disporre del relativo contenuto in System anche se non dispongono delle autorizzazioni per montarlo autonomamente. |Disabilitare il servizio autofs o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-autofs ' |
|Verificare che il montaggio dei dispositivi di archiviazione USB sia disabilitato<br /><sub>(1.1.21.1)</sub> |Descrizione: la rimozione del supporto per i dispositivi di archiviazione USB riduce la superficie di attacco locale del server. |Modificare o creare un file nella `/etc/modprobe.d/` directory che termina con. conf e aggiungere `install usb-storage /bin/true` quindi scaricare il modulo USB-storage o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|Verificare che i dump principali siano limitati.<br /><sub>1.5.1</sub> |Descrizione: l'impostazione di un limite rigido per i dump di base impedisce agli utenti di eseguire l'override della variabile flessibile. Se sono necessari dump di base, provare a impostare i limiti per i gruppi di utenti (vedere `limits.conf(5)` ). Inoltre, l'impostazione della `fs.suid_dumpable` variabile su 0 impedirà ai programmi setuid di eseguire il dump di core. |Aggiungere `hard core 0` a/etc/security/limits.conf. o a un file nella directory limits. d e impostare `fs.suid_dumpable = 0` in sysctl o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Core-dumps ' |
|Assicurarsi che prelink sia disabilitato.<br /><sub>1.5.4</sub> |Descrizione: la funzionalità di precollegamento può interferire con il funzionamento di AIDE, perché modifica i file binari. Il precollegamento può anche aumentare la vulnerabilità del sistema se un utente malintenzionato è in grado di compromettere una libreria comune, ad esempio libc. |disinstallare `prelink` usando Gestione pacchetti o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Remove-prelink ' |
|Verificare che le autorizzazioni per/etc/motd siano configurate.<br /><sub>(1.7.1.4)</sub> |Descrizione: se il `/etc/motd` file non dispone della proprietà corretta, potrebbe essere modificato da utenti non autorizzati con informazioni errate o fuorvianti. |Impostare il proprietario e il gruppo di/etc/motd su root e impostare le autorizzazioni su 0644 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verificare che le autorizzazioni per/etc/issue siano configurate.<br /><sub>(1.7.1.5)</sub> |Descrizione: se il `/etc/issue` file non dispone della proprietà corretta, potrebbe essere modificato da utenti non autorizzati con informazioni errate o fuorvianti. |Impostare il proprietario e il gruppo di/etc/issue su root e impostare le autorizzazioni su 0644 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verificare che le autorizzazioni per/etc/issue.NET siano configurate.<br /><sub>1.7.1.6</sub> |Descrizione: se il `/etc/issue.net` file non dispone della proprietà corretta, potrebbe essere modificato da utenti non autorizzati con informazioni errate o fuorvianti. |Impostare il proprietario e il gruppo di/etc/issue.NET su root e impostare le autorizzazioni su 0644 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|L'opzione nodev deve essere abilitata per tutti i supporti rimovibili.<br /><sub>(2,1)</sub> |Descrizione: un utente malintenzionato potrebbe montare un dispositivo speciale, ad esempio un blocco o un dispositivo a caratteri, tramite supporti rimovibili |Aggiungere l'opzione nodev al quarto campo (opzioni di montaggio) in/etc/fstab |
|L'opzione NOEXEC deve essere abilitata per tutti i supporti rimovibili.<br /><sub>(2,2)</sub> |Descrizione: un utente malintenzionato potrebbe caricare il file eseguibile tramite supporti rimovibili |Aggiungere l'opzione NOEXEC al quarto campo (opzioni di montaggio) in/etc/fstab |
|L'opzione nosuid deve essere abilitata per tutti i supporti rimovibili.<br /><sub>(2,3)</sub> |Descrizione: un utente malintenzionato potrebbe caricare file che vengono eseguiti con un contesto di sicurezza con privilegi elevati tramite supporti rimovibili |Aggiungere l'opzione nosuid al quarto campo (opzioni di montaggio) in/etc/fstab |
|Assicurarsi che Talk client non sia installato.<br /><sub>2.3.3</sub> |Descrizione: il software presenta un rischio per la sicurezza poiché usa protocolli non crittografati per la comunicazione. |Disinstallare `talk`  o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Remove-Talk ' |
|Verificare che le autorizzazioni per/etc/hosts.allow siano configurate.<br /><sub>3.4.4</sub> |Descrizione: è fondamentale assicurarsi che il `/etc/hosts.allow` file sia protetto da accesso in scrittura non autorizzato. Sebbene sia protetta per impostazione predefinita, le autorizzazioni per i file possono essere modificate inavvertitamente o tramite azioni dannose. |Impostare il proprietario e il gruppo di/etc/hosts.allow su root e le autorizzazioni per 0644 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verificare che le autorizzazioni per/etc/hosts.Deny siano configurate.<br /><sub>3.4.5</sub> |Descrizione: è fondamentale assicurarsi che il `/etc/hosts.deny` file sia protetto da accesso in scrittura non autorizzato. Sebbene sia protetta per impostazione predefinita, le autorizzazioni per i file possono essere modificate inavvertitamente o tramite azioni dannose. |Impostare il proprietario e il gruppo di/etc/hosts.Deny su root e le autorizzazioni per 0644 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r file-permissions ' |
|Verificare che i criteri di negazione del firewall siano predefiniti<br /><sub>3.6.2</sub> |Descrizione: con un criterio di accettazione predefinito, il firewall accetterà qualsiasi pacchetto non configurato per essere negato. È più facile mantenere un firewall protetto con un criterio di eliminazione predefinito rispetto a un criterio di autorizzazione predefinito. |Impostare i criteri predefiniti per il traffico in ingresso, in uscita e indirizzati a o a seconda delle `deny` `reject` esigenze usando il software firewall |
|L'opzione nodev/nosuid deve essere abilitata per tutti i montaggi NFS.<br /><sub>(5)</sub> |Descrizione: un utente malintenzionato potrebbe caricare file che vengono eseguiti con un contesto di sicurezza con privilegi elevati o dispositivi speciali tramite file system remoto |Aggiungere le opzioni nosuid e nodev al quarto campo (opzioni di montaggio) in/etc/fstab |
|Verificare che siano configurati i requisiti di creazione della password<br /><sub>5.3.1</sub> |Descrizione: le password complesse proteggono i sistemi da hacker tramite metodi di forza bruta. |Impostare le coppie chiave/valore seguenti nel PAM appropriato per la distribuzione: MinLen = 14, minclass = 4, dcredit =-1, ucredit =-1, ocredit =-1, lcredit =-1 oppure eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r enable-password-requirements ' |
|Verificare che il blocco per i tentativi di accesso con password non riuscita sia configurato.<br /><sub>5.3.2</sub> |Descrizione: il blocco degli ID utente dopo `n` tentativi di accesso consecutivi non riusciti attenua gli attacchi di forza bruta alle password nei sistemi. |per Ubuntu e Debian aggiungere i moduli pam_tally e pam_deny in base alle esigenze. Per tutte le altre distribuzioni, fare riferimento alla documentazione della distribuzione |
|Disabilitare l'installazione e l'utilizzo di file System non necessari (CRAMFS)<br /><sub>(6,1)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in CRAMFS per elevare i privilegi |Aggiungere un file alla directory/etc/modprob.d che Disabilita CRAMFS o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|Disabilitare l'installazione e l'utilizzo di file System non necessari (freevxfs)<br /><sub>(6,2)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in freevxfs per elevare i privilegi |Aggiungere un file alla directory/etc/modprob.d che Disabilita freevxfs o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|Verificare che siano presenti tutte le Home directory degli utenti<br /><sub>6.2.7</sub> |Descrizione: se la home directory dell'utente non esiste o non è assegnata, l'utente verrà inserito in '/' e non sarà in grado di scrivere alcun file o di disporre di variabili di ambiente locali impostate. |Se la home directory degli utenti non esiste, crearla e assicurarsi che il rispettivo utente appartenga alla directory. Gli utenti senza una home directory assegnata devono essere rimossi o assegnati a una home directory nel modo appropriato. |
|Assicurarsi che gli utenti possiedano la home directory<br /><sub>6.2.9</sub> |Descrizione: poiché l'utente è responsabile per i file archiviati nella home directory dell'utente, è necessario che l'utente sia il proprietario della directory. |Modificare la proprietà di tutte le Home directory che non sono di proprietà dell'utente definito per l'utente corretto. |
|Assicurarsi che i file di punto degli utenti non siano di gruppo o che siano scrivibile dal mondo.<br /><sub>6.2.10</sub> |Descrizione: i file di configurazione dell'utente di gruppo o globale possono consentire a utenti malintenzionati di rubare o modificare i dati di altri utenti o di ottenere i privilegi di sistema di un altro utente. |Apportare modifiche globali ai file degli utenti senza avvisare la community degli utenti può comportare interruzioni impreviste e utenti scontenti. Pertanto, è consigliabile stabilire un criterio di monitoraggio per segnalare le autorizzazioni per i file di punti utente e determinare l'azione da intraprendere in base ai criteri del sito. |
|Assicurarsi che nessun utente abbia file con estensione.<br /><sub>6.2.11</sub> |Descrizione: l'utilizzo del `.forward` file costituisce un rischio per la sicurezza in quanto i dati sensibili possono essere trasferiti inavvertitamente all'esterno dell'organizzazione. Il `.forward` file rappresenta anche un rischio perché può essere usato per eseguire comandi che possono eseguire azioni non intenzionali. |Apportare modifiche globali ai file degli utenti senza avvisare la community degli utenti può comportare interruzioni impreviste e utenti scontenti. Pertanto, è consigliabile stabilire un criterio di monitoraggio per segnalare `.forward` i file utente e determinare l'azione da intraprendere in base ai criteri del sito. |
|Assicurarsi che nessun utente abbia file con estensione netrc<br /><sub>6.2.12</sub> |Descrizione: il `.netrc` file presenta un rischio di sicurezza significativo perché archivia le password in formato non crittografato. Anche se FTP è disabilitato, è possibile che gli account utente abbiano introdotto `.netrc` i file da altri sistemi che potrebbero rappresentare un rischio per tali sistemi |Apportare modifiche globali ai file degli utenti senza avvisare la community degli utenti può comportare interruzioni impreviste e utenti scontenti. Pertanto, è consigliabile stabilire un criterio di monitoraggio per segnalare `.netrc` i file utente e determinare l'azione da intraprendere in base ai criteri del sito. |
|Assicurarsi che nessun utente abbia file con estensione rhosts<br /><sub>(6.2.14)</sub> |Descrizione: questa azione è significativa solo se `.rhosts` nel file è consentito il supporto `/etc/pam.conf` . Anche se i `.rhosts` file sono inefficaci se il supporto è disabilitato in `/etc/pam.conf` , è possibile che siano stati portati da altri sistemi e che contengano informazioni utili a un utente malintenzionato per tali sistemi. |Apportare modifiche globali ai file degli utenti senza avvisare la community degli utenti può comportare interruzioni impreviste e utenti scontenti. Pertanto, è consigliabile stabilire un criterio di monitoraggio per segnalare `.rhosts` i file utente e determinare l'azione da intraprendere in base ai criteri del sito. |
|Verificare che tutti i gruppi in/etc/passwd esistano in/etc/Group<br /><sub>6.2.15</sub> |Descrizione: i gruppi definiti nel file/etc/passwd, ma non nel file/etc/Group, rappresentano una minaccia per la sicurezza del sistema poiché le autorizzazioni di gruppo non sono gestite correttamente. |Per ogni gruppo definito in/etc/passwd, verificare che sia presente un gruppo corrispondente in/etc/Group |
|Assicurarsi che non esistano UID duplicati<br /><sub>(6.2.16)</sub> |Descrizione: agli utenti deve essere assegnato un UID univoco per la responsabilità e garantire Protezioni di accesso appropriate. |Stabilire gli UID univoci ed esaminare tutti i file di proprietà degli UID condivisi per determinare a quale UID deve appartenere. |
|Assicurarsi che non esistano GID duplicati<br /><sub>(6.2.17)</sub> |Descrizione: ai gruppi è necessario assegnare GID univoci per la responsabilità e garantire Protezioni di accesso appropriate. |Definire GID univoche ed esaminare tutti i file di proprietà del GID condiviso per determinare a quale GID si suppone appartenga. |
|Assicurarsi che non esistano nomi utente duplicati<br /><sub>(6.2.18)</sub> |Descrizione: se a un utente viene assegnato un nome utente duplicato, verrà creato e avrà accesso ai file con il primo UID per il nome utente in `/etc/passwd` . Se ad esempio ' test4' ha un UID di 1000 e una voce successiva ' test4' ha un UID di 2000, l'accesso come ' test4' userà UID 1000. In realtà, l'UID è condiviso, che rappresenta un problema di sicurezza. |Definire nomi utente univoci per gli utenti. Le proprietà dei file rifletteranno automaticamente la modifica a condizione che gli utenti dispongano di UID univoci. |
|Assicurarsi che non esistano gruppi duplicati<br /><sub>(6.2.19)</sub> |Descrizione: se a un gruppo viene assegnato un nome di gruppo duplicato, verrà creato e avrà accesso ai file con il primo GID per il gruppo in `/etc/group` . In realtà, il GID è condiviso, un problema di sicurezza. |Stabilire nomi univoci per i gruppi di utenti. Le proprietà dei gruppi di file rifletteranno automaticamente la modifica a condizione che i gruppi abbiano GID univoci. |
|Verificare che il gruppo shadow sia vuoto<br /><sub>(6.2.20)</sub> |Descrizione: a tutti gli utenti assegnati al gruppo shadow viene concesso l'accesso in lettura al file/etc/shadow. Se gli utenti malintenzionati possono ottenere l'accesso in lettura al `/etc/shadow` file, possono eseguire facilmente un programma di cracking delle password con le password con hash per suddividerli. Altre informazioni di sicurezza archiviate nel `/etc/shadow` file, ad esempio la scadenza, possono essere utili anche per sovvertire gli account utente aggiuntivi. |Rimuovere tutti gli utenti dal gruppo shadow |
|Disabilitare l'installazione e l'uso di file System non necessari (HFS)<br /><sub>(6,3)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in HFS per elevare i privilegi |Aggiungere un file alla directory/etc/modprob.d che Disabilita HFS o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|Disabilitare l'installazione e l'utilizzo di file System non necessari (hfsplus)<br /><sub>(6,4)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in hfsplus per elevare i privilegi |Aggiungere un file alla directory/etc/modprob.d che Disabilita hfsplus o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|Disabilitare l'installazione e l'utilizzo di file System non necessari (jffs2)<br /><sub>(6,5)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in jffs2 per elevare i privilegi |Aggiungere un file alla directory/etc/modprob.d che Disabilita jffs2 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-unsuperflu-kernel-mods ' |
|I kernel devono essere compilati solo da origini approvate.<br /><sub>10</sub> |Descrizione: un kernel da un'origine non approvata potrebbe contenere vulnerabilità o backdoor per concedere l'accesso a un utente malintenzionato. |Installare il kernel fornito dal fornitore della distribuzione. |
|le autorizzazioni per i file/etc/shadow devono essere impostate su 0400<br /><sub>(11,1)</sub> |Descrizione: un utente malintenzionato che può recuperare o modificare le password con hash da/etc/shadow se non è protetto correttamente. |Impostare le autorizzazioni e la proprietà di/etc/shadow * o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-shadow-perms ' |
|le autorizzazioni per i file/etc/shadow-devono essere impostate su 0400<br /><sub>(11,2)</sub> |Descrizione: un utente malintenzionato che può recuperare o modificare le password con hash da/etc/shadow-se non è protetto correttamente. |Impostare le autorizzazioni e la proprietà di/etc/shadow * o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-shadow-perms ' |
|le autorizzazioni per i file/etc/gshadow devono essere impostate su 0400<br /><sub>(11,3)</sub> |Descrizione: un utente malintenzionato potrebbe partecipare a gruppi di sicurezza se il file non è protetto correttamente |Impostare le autorizzazioni e la proprietà di/etc/gshadow-o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-gshadow-perms ' |
|le autorizzazioni per i file/etc/gshadow-devono essere impostate su 0400<br /><sub>(11,4)</sub> |Descrizione: un utente malintenzionato potrebbe partecipare a gruppi di sicurezza se il file non è protetto correttamente |Impostare le autorizzazioni e la proprietà di/etc/gshadow o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-gshadow-perms ' |
|le autorizzazioni per i file/etc/passwd devono essere 0644<br /><sub>(12,1)</sub> |Descrizione: un utente malintenzionato potrebbe modificare gli userID e le shell di accesso |Impostare le autorizzazioni e la proprietà di/etc/passwd o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-passwd-perms ' |
|le autorizzazioni per i file/etc/Group devono essere 0644<br /><sub>(12,2)</sub> |Descrizione: un utente malintenzionato potrebbe elevare i privilegi modificando l'appartenenza al gruppo |Impostare le autorizzazioni e la proprietà di/etc/group o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-group-perms |
|le autorizzazioni per i file/etc/passwd-devono essere impostate su 0600<br /><sub>(12,3)</sub> |Descrizione: un utente malintenzionato potrebbe partecipare a gruppi di sicurezza se il file non è protetto correttamente |Impostare le autorizzazioni e la proprietà di/etc/passwd-o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-passwd-perms |
|le autorizzazioni per i file/etc/Group-devono essere 0644<br /><sub>(12,4)</sub> |Descrizione: un utente malintenzionato potrebbe elevare i privilegi modificando l'appartenenza al gruppo |Impostare le autorizzazioni e la proprietà di/etc/group-o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-etc-group-perms |
|L'accesso all'account radice tramite su deve essere limitato al gruppo ' root '<br /><sub>21</sub> |Descrizione: un utente malintenzionato potrebbe eseguire l'escalation delle autorizzazioni in base all'ipotesi di password se su non è limitato agli utenti del gruppo radice. |Eseguire il comando "/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-su-Permissions". Verrà aggiunta la riga ' auth required pam_wheel. so use_uid ' al file '/etc/pam.d/su ' |
|Il gruppo ' root ' deve esistere e contenere tutti i membri che possono eseguire su nella radice<br /><sub>22</sub> |Descrizione: un utente malintenzionato potrebbe eseguire l'escalation delle autorizzazioni in base all'ipotesi di password se su non è limitato agli utenti del gruppo radice. |Creare il gruppo radice tramite il comando ' groupadd-g 0 root ' |
|Nessun account senza password<br /><sub>(23,2)</sub> |Descrizione: un utente malintenzionato può accedere a account senza password ed eseguire comandi arbitrari. |Usare il comando passwd per impostare le password per tutti gli account |
|Per gli account diversi dalla radice deve essere presente un UID univoco maggiore di zero (0)<br /><sub>24</sub> |Descrizione: se un account diverso dalla radice ha UID zero, un utente malintenzionato potrebbe compromettere l'account e ottenere i privilegi radice. |Assegnare gli UID univoci e diversi da zero a tutti gli account non radice con ' usermod-u ' |
|Il posizionamento casuale delle aree della memoria virtuale deve essere abilitato<br /><sub>25</sub> |Descrizione: un utente malintenzionato potrebbe scrivere codice eseguibile in aree note in memoria con l'elevazione dei privilegi |Aggiungere il valore ' 1' o ' 2' al file '/proc/sys/kernel/randomize_va_space ' |
|È necessario abilitare il supporto del kernel per la funzionalità del processore XD/NX<br /><sub>26</sub> |Descrizione: un utente malintenzionato potrebbe causare il codice eseguibile di un sistema dalle aree dati in memoria, con conseguente elevazione dei privilegi. |Confermare che il file '/proc/cpuinfo ' contiene il flag ' NX ' |
|Il ' .' non deve essere visualizzato nella $PATH radice<br /><sub>(27,1)</sub> |Descrizione: un utente malintenzionato potrebbe elevare i privilegi inserendo un file dannoso nella $PATH della radice |Modificare la riga ' export PATH =' in/root/.profile |
|Le Home directory dell'utente devono essere in modalità 750 o più restrittive<br /><sub>28</sub> |Descrizione: un utente malintenzionato potrebbe recuperare informazioni riservate dalle cartelle Home di altri utenti. |Impostare le autorizzazioni della Home directory su 750 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-Home-dir-Permissions |
|Il valore predefinito di umask per tutti gli utenti deve essere impostato su 077 in login. defs<br /><sub>29</sub> |Descrizione: un utente malintenzionato potrebbe recuperare informazioni riservate dai file di proprietà di altri utenti. |Eseguire il comando '/opt/Microsoft/omsagent/plugin/omsremediate-r set-default-user-umask '. Verrà aggiunta la riga ' UMASK 077' al file '/etc/login.defs ' |
|Per tutti i bootloader è necessario abilitare la protezione con password.<br /><sub>31</sub> |Descrizione: un utente malintenzionato con accesso fisico potrebbe modificare le opzioni del bootloader, restituendo l'accesso al sistema senza restrizioni |Aggiungere una password del caricatore di avvio al file '/boot/grub/grub.cfg ' |
|Verificare che siano configurate le autorizzazioni nella configurazione del bootloader<br /><sub>(31,1)</sub> |Descrizione: l'impostazione delle autorizzazioni per la lettura e la scrittura per la radice impedisce solo agli utenti non root di visualizzare i parametri di avvio o di modificarli. Gli utenti non radice che leggono i parametri di avvio potrebbero essere in grado di identificare i punti deboli nella sicurezza al momento dell'avvio ed essere in grado di sfruttarli. |Impostare il proprietario e il gruppo del bootloader sulla radice: radice e autorizzazioni per 0400 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r bootloader-autorizzazioni |
|Assicurarsi che l'autenticazione sia necessaria per la modalità utente singolo.<br /><sub>(33)</sub> |Descrizione: la richiesta di autenticazione in modalità utente singolo impedisce a un utente non autorizzato di riavviare il sistema in un singolo utente per ottenere i privilegi radice senza credenziali. |eseguire il comando seguente per impostare una password per l'utente root: `passwd root` |
|Verificare che l'invio del reindirizzamento del pacchetto sia disabilitato.<br /><sub>(38,3)</sub> |Descrizione: un utente malintenzionato potrebbe usare un host compromesso per inviare reindirizzamenti ICMP non validi ad altri dispositivi router nel tentativo di danneggiare il routing e consentire agli utenti di accedere a un sistema configurato dall'utente malintenzionato rispetto a un sistema valido. |impostare i parametri seguenti in/etc/sysctl.conf:' net.ipv4.conf.all.send_redirects = 0' è net.ipv4.conf.default.send_redirects = 0' o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Send-redirects |
|L'invio di reindirizzamenti ICMP deve essere disabilitato per tutte le interfacce. (net.ipv4.conf.default.accept_redirects = 0)<br /><sub>(38,4)</sub> |Descrizione: un utente malintenzionato potrebbe modificare la tabella di routing del sistema, reindirizzando il traffico a una destinazione alternativa |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire "/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-redirects". |
|L'invio di reindirizzamenti ICMP deve essere disabilitato per tutte le interfacce. (net.ipv4.conf.default.secure_redirects = 0)<br /><sub>(38,5)</sub> |Descrizione: un utente malintenzionato potrebbe modificare la tabella di routing del sistema, reindirizzando il traffico a una destinazione alternativa |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Secure-Redirectors ' |
|L'accettazione dei pacchetti indirizzati di origine deve essere disabilitata per tutte le interfacce. (net.ipv4.conf.all.accept_source_route = 0)<br /><sub>(40,1)</sub> |Descrizione: un utente malintenzionato potrebbe reindirizzare il traffico per scopi dannosi. |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-source-route ' |
|L'accettazione dei pacchetti indirizzati di origine deve essere disabilitata per tutte le interfacce. (net.ipv6.conf.all.accept_source_route = 0) o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Accept-source-route '<br /><sub>(40,2)</sub> |Descrizione: un utente malintenzionato potrebbe reindirizzare il traffico per scopi dannosi. |Eseguire `sysctl -w key=value` e impostare su un valore conforme. |
|È necessario abilitare le risposte ICMP fasulle alle trasmissioni. (net.ipv4.icmp_ignore_bogus_error_responses = 1)<br /><sub>(43)</sub> |Descrizione: un utente malintenzionato potrebbe eseguire un attacco ICMP risultante da DoS |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-ICMP-ignore-false-Error-Responses ' |
|Le richieste echo ICMP (ping) inviate agli indirizzi broadcast/multicast devono essere abilitate. (net.ipv4.icmp_echo_ignore_broadcasts = 1)<br /><sub>(44)</sub> |Descrizione: un utente malintenzionato potrebbe eseguire un attacco ICMP risultante da DoS |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-ICMP-Echo-igno-broadcasts ' |
|È necessario abilitare la registrazione dei pacchetti marziani (quelli con indirizzi non consentiti) per tutte le interfacce. (net.ipv4.conf.all.log_martians = 1)<br /><sub>(45,1)</sub> |Descrizione: un utente malintenzionato potrebbe inviare il traffico da indirizzi falsificati senza essere rilevati |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r enable-log-marzians ' |
|L'esecuzione della convalida dell'origine per percorso inverso deve essere abilitata per tutte le interfacce. (net.ipv4.conf.all.rp_filter = 1)<br /><sub>(46,1)</sub> |Descrizione: il sistema accetterà il traffico da indirizzi non instradabili. |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-RP-Filter ' |
|L'esecuzione della convalida dell'origine per percorso inverso deve essere abilitata per tutte le interfacce. (net.ipv4.conf.default.rp_filter = 1)<br /><sub>(46,2)</sub> |Descrizione: il sistema accetterà il traffico da indirizzi non instradabili. |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-RP-Filter ' |
|È necessario abilitare il syncookies TCP. (net.ipv4.tcp_syncookies = 1)<br /><sub>(47)</sub> |Descrizione: un utente malintenzionato potrebbe eseguire un DoS su TCP |Eseguire `sysctl -w key=value` e impostare su un valore conforme o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-TCP-syncookies ' |
|Il sistema non deve fungere da sniffer di rete.<br /><sub>(48)</sub> |Descrizione: un utente malintenzionato può usare interfacce promiscue per sniffare il traffico di rete |La modalità promiscua è abilitata tramite una voce ' provarie ' in '/etc/network/interfaces ' o '/etc/rc.local.' Controllare entrambi i file e rimuovere questa voce. |
|Tutte le interfacce wireless devono essere disabilitate.<br /><sub>(49)</sub> |Descrizione: un utente malintenzionato potrebbe creare un punto di accesso fasullo per intercettare le trasmissioni. |Verificare che tutte le interfacce wireless siano disabilitate in '/etc/network/interfaces ' |
|Il protocollo IPv6 deve essere abilitato.<br /><sub>(50)</sub> |Descrizione: questa operazione è necessaria per la comunicazione su reti moderne. |Aprire/etc/sysctl.conf e verificare che ' net.ipv6.conf.all.disable_ipv6' è net.ipv6.conf.default.disable_ipv6' siano impostati su 0 |
|Verificare che DCCP sia disabilitato<br /><sub>(54)</sub> |Descrizione: se il protocollo non è obbligatorio, è consigliabile non installare i driver per ridurre la potenziale superficie di attacco. |Modificare o creare un file nella `/etc/modprobe.d/` directory che termina con. conf e aggiungere `install dccp /bin/true` quindi scaricare il modulo DCCP o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-superflu-kernel-mods ' |
|Verificare che SCTP sia disabilitato<br /><sub>(55)</sub> |Descrizione: se il protocollo non è obbligatorio, è consigliabile non installare i driver per ridurre la potenziale superficie di attacco. |Modificare o creare un file nella `/etc/modprobe.d/` directory che termina con. conf e aggiungere `install sctp /bin/true` quindi scaricare il modulo SCTP o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-superflu-kernel-mods ' |
|Disabilitare il supporto per Servizi Desktop remoto.<br /><sub>(56)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità in RDS per compromettere il sistema |Modificare o creare un file nella `/etc/modprobe.d/` directory che termina con. conf e aggiungere `install rds /bin/true` quindi scaricare il modulo RDS o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-superflu-kernel-mods ' |
|Verificare che TIPC sia disabilitato<br /><sub>(57)</sub> |Descrizione: se il protocollo non è obbligatorio, è consigliabile non installare i driver per ridurre la potenziale superficie di attacco. |Modificare o creare un file nella `/etc/modprobe.d/` directory che termina con. conf e aggiungere `install tipc /bin/true` quindi scaricare il modulo tipc o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-superflu-kernel-mods ' |
|Verificare che la registrazione sia configurata<br /><sub>(60)</sub> |Descrizione: viene inviata una grande quantità di importanti informazioni relative alla sicurezza tramite, `rsyslog` ad esempio i tentativi di accesso con esito positivo e negativo, i tentativi di accesso non riusciti, i tentativi di accesso radice e così via. |Configurare syslog, rsyslog o syslog-ng nel modo appropriato |
|È necessario installare il pacchetto syslog, rsyslog o syslog-ng.<br /><sub>(61)</sub> |Descrizione: i problemi di affidabilità e sicurezza non verranno registrati, impedendo una diagnosi corretta. |Installare il pacchetto rsyslog o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r install-rsyslog ' |
|Verificare che sia abilitato un servizio di registrazione<br /><sub>(62)</sub> |Descrizione: è necessario avere la possibilità di registrare gli eventi in un nodo. |Abilitare il pacchetto rsyslog o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Enable-rsyslog ' |
|Le autorizzazioni per tutti i file di log rsyslog devono essere impostate su 640 o 600.<br /><sub>(63)</sub> |Descrizione: un utente malintenzionato potrebbe coprire le attività manipolando i log |Aggiungere la riga ' $FileCreateMode 0640' al file '/etc/rsyslog.conf ' |
|Verificare che i file di configurazione del logger siano limitati.<br /><sub>(63,1)</sub> |Descrizione: è importante assicurarsi che i file di registro esistano e dispongano delle autorizzazioni corrette per garantire che i dati di syslog sensibili siano archiviati e protetti. |Impostare i file di configurazione del logger su 0640 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r logger-config-file-permissions ' |
|Tutti i file di log rsyslog devono essere di proprietà del gruppo ADM.<br /><sub>(64)</sub> |Descrizione: un utente malintenzionato potrebbe coprire le attività manipolando i log |Aggiungere la riga ' $FileGroup ADM ' al file '/etc/rsyslog.conf ' |
|Tutti i file di log rsyslog devono essere di proprietà dell'utente syslog.<br /><sub>(65)</sub> |Descrizione: un utente malintenzionato potrebbe coprire le attività manipolando i log |Aggiungere la riga ' $FileOwner syslog ' al file '/etc/rsyslog.conf ' o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r syslog-Owner |
|Rsyslog non deve accettare messaggi remoti.<br /><sub>(67)</sub> |Descrizione: un utente malintenzionato potrebbe inserire messaggi in syslog, causando un DoS o una distrazione da altre attività |Rimuovere le righe ' $ModLoad imudp ' è $ModLoad imtcp ' dal file '/etc/rsyslog.conf ' |
|Il servizio logrotate (syslog Rotator) deve essere abilitato.<br /><sub>(68)</sub> |Descrizione: i file di log potrebbero crescere senza limiti e utilizzare tutto lo spazio su disco |Installare il pacchetto logrotate e verificare che la voce logrotate cron sia attiva (chmod 755/etc/cron.Daily/logrotate; chown root: root/etc/cron.Daily/logrotate) |
|Il servizio rlogin deve essere disabilitato.<br /><sub>(69)</sub> |Descrizione: un utente malintenzionato potrebbe ottenere l'accesso, ignorando i requisiti di autenticazione rigidi |Rimuovere il servizio inetd. |
|Disabilitare inetd a meno che non sia richiesto. inetd<br /><sub>(70,1)</sub> |Descrizione: un utente malintenzionato potrebbe sfruttare una vulnerabilità in un servizio inetd per ottenere l'accesso |Disinstallare il servizio inetd (apt-get remove inetd) |
|Disabilitare xinetd, a meno che non sia richiesto. xinetd<br /><sub>(70,2)</sub> |Descrizione: un utente malintenzionato potrebbe sfruttare una vulnerabilità in un servizio xinetd per ottenere l'accesso |Disinstallare il servizio inetd (apt-get remove xinetd) |
|Installare inetd solo se appropriato e richiesto dalla distribuzione. Sicurezza in base agli standard di protezione avanzata correnti. (se necessario)<br /><sub>(71,1)</sub> |Descrizione: un utente malintenzionato potrebbe sfruttare una vulnerabilità in un servizio inetd per ottenere l'accesso |Disinstallare il servizio inetd (apt-get remove inetd) |
|Installare xinetd solo se appropriato e richiesto dalla distribuzione. Sicurezza in base agli standard di protezione avanzata correnti. (se necessario)<br /><sub>(71,2)</sub> |Descrizione: un utente malintenzionato potrebbe sfruttare una vulnerabilità in un servizio xinetd per ottenere l'accesso |Disinstallare il servizio inetd (apt-get remove xinetd) |
|Il servizio Telnet deve essere disabilitato.<br /><sub>(72)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o usurpare sessioni Telnet non crittografate |Rimuovere o impostare come commento la voce Telnet nel file "/etc/inetd.conf" |
|Tutti i pacchetti telnetd devono essere disinstallati.<br /><sub>(73)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o usurpare sessioni Telnet non crittografate |Disinstalla tutti i pacchetti telnetd |
|Il servizio RCP/rsh dovrebbe essere disabilitato.<br /><sub>(74)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o usurpare sessioni non crittografate |Rimuovere o impostare come commento la voce della shell nel file "/etc/inetd.conf" |
|Il pacchetto rsh-server deve essere disinstallato.<br /><sub>(77)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o usurpare sessioni rsh non crittografate |Disinstallare il pacchetto rsh-Server (apt-get remove rsh-Server) |
|Il servizio ypbind deve essere disabilitato.<br /><sub>(78)</sub> |Descrizione: un utente malintenzionato potrebbe recuperare informazioni riservate dal servizio ypbind |Disinstallare il pacchetto NIS (apt-get remove NIS) |
|È necessario disinstallare il pacchetto NIS.<br /><sub>(79)</sub> |Descrizione: un utente malintenzionato potrebbe recuperare informazioni riservate dal servizio NIS |Disinstallare il pacchetto NIS (apt-get remove NIS) |
|Il servizio TFTP dovrebbe essere disabilitato.<br /><sub>(80)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o dirottare una sessione non crittografata |Rimuovere la voce TFTP dal file "/etc/inetd.conf" |
|Il pacchetto tftpd deve essere disinstallato.<br /><sub>(81)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o dirottare una sessione non crittografata |Disinstallare il pacchetto tftpd (apt-get, Rimuovi TFTPD) |
|Il pacchetto read-ahead-Fedora deve essere disinstallato.<br /><sub>(82)</sub> |Descrizione: nessuna esposizione sostanziale, ma anche nessun vantaggio sostanziale |Disinstallare il pacchetto read-ahead-Fedora (apt-get remove read-ahead-Fedora) |
|Il servizio Bluetooth/Hidde deve essere disabilitato.<br /><sub>(84)</sub> |Descrizione: un utente malintenzionato potrebbe intercettare o modificare le comunicazioni wireless. |Disinstallare il pacchetto Bluetooth (apt-get remove Bluetooth) |
|Il servizio ISDN deve essere disabilitato.<br /><sub>(86)</sub> |Descrizione: un utente malintenzionato potrebbe usare un modem per ottenere l'accesso non autorizzato |Disinstallare il pacchetto isdnutils-base (apt-get remove isdnutils-base) |
|Il pacchetto isdnutils-base deve essere disinstallato.<br /><sub>(87)</sub> |Descrizione: un utente malintenzionato potrebbe usare un modem per ottenere l'accesso non autorizzato |Disinstallare il pacchetto isdnutils-base (apt-get remove isdnutils-base) |
|Il servizio kdump deve essere disabilitato.<br /><sub>(88)</sub> |Descrizione: un utente malintenzionato potrebbe analizzare un arresto anomalo del sistema precedente per recuperare informazioni riservate |Disinstallare il pacchetto kdump-Tools (apt-get remove kdump-Tools) |
|Zeroconf rete deve essere disabilitata.<br /><sub>(89)</sub> |Descrizione: è possibile che un utente malintenzionato usi questo comportamento per ottenere informazioni sui sistemi di rete o per eseguire lo spoofing delle richieste DNS a causa di difetti nel modello di attendibilità |Per RedHat, CentOS e Oracle: Aggiungi `NOZEROCONF=yes or no` a/etc/sysconfig/network. Per tutte le altre distribuzioni: rimuovere tutte le voci ' IPv4LL ' nel file '/etc/network/interfaces ' o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-Zeroconf ' |
|Il servizio crond deve essere abilitato.<br /><sub>(90)</sub> |Descrizione: cron è richiesto da quasi tutti i sistemi per le normali attività di manutenzione |Installare il pacchetto cron (apt-get install-y cron) e confermare che il file '/etc/init/cron.conf ' contiene la riga ' Start on runlevel [2345]' |
|Le autorizzazioni per i file per/etc/anacrontab devono essere impostate su root: root 600.<br /><sub>(91)</sub> |Descrizione: un utente malintenzionato potrebbe modificare questo file per impedire attività pianificate o eseguire attività dannose |Impostare la proprietà e le autorizzazioni in/etc/anacrontab o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-anacrontab-perms ' |
|Verificare che le autorizzazioni per/etc/cron.d siano configurate.<br /><sub>(93)</sub> |Descrizione: la concessione dell'accesso in scrittura a questa directory per gli utenti senza privilegi potrebbe fornire loro i mezzi per ottenere privilegi elevati non autorizzati. La concessione dell'accesso in lettura a questa directory potrebbe offrire agli utenti senza privilegi informazioni dettagliate su come ottenere privilegi elevati o aggirare i controlli di controllo. |Impostare il proprietario e il gruppo di/etc/Chron.d su root e le autorizzazioni per 0700 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms ' |
|Verificare che le autorizzazioni per/etc/cron.Daily siano configurate.<br /><sub>(94)</sub> |Descrizione: la concessione dell'accesso in scrittura a questa directory per gli utenti senza privilegi potrebbe fornire loro i mezzi per ottenere privilegi elevati non autorizzati. La concessione dell'accesso in lettura a questa directory potrebbe offrire agli utenti senza privilegi informazioni dettagliate su come ottenere privilegi elevati o aggirare i controlli di controllo. |Impostare il proprietario e il gruppo di/etc/Chron.Daily su root e le autorizzazioni per 0700 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verificare che le autorizzazioni per/etc/cron.hourly siano configurate.<br /><sub>(95)</sub> |Descrizione: la concessione dell'accesso in scrittura a questa directory per gli utenti senza privilegi potrebbe fornire loro i mezzi per ottenere privilegi elevati non autorizzati. La concessione dell'accesso in lettura a questa directory potrebbe offrire agli utenti senza privilegi informazioni dettagliate su come ottenere privilegi elevati o aggirare i controlli di controllo. |Impostare il proprietario e il gruppo di/etc/Chron.hourly su root e le autorizzazioni per 0700 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verificare che le autorizzazioni per/etc/cron.Monthly siano configurate.<br /><sub>(96)</sub> |Descrizione: la concessione dell'accesso in scrittura a questa directory per gli utenti senza privilegi potrebbe fornire loro i mezzi per ottenere privilegi elevati non autorizzati. La concessione dell'accesso in lettura a questa directory potrebbe offrire agli utenti senza privilegi informazioni dettagliate su come ottenere privilegi elevati o aggirare i controlli di controllo. |Impostare il proprietario e il gruppo di/etc/Chron.Monthly su root e le autorizzazioni per 0700 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Verificare che le autorizzazioni per/etc/cron.Weekly siano configurate.<br /><sub>(97)</sub> |Descrizione: la concessione dell'accesso in scrittura a questa directory per gli utenti senza privilegi potrebbe fornire loro i mezzi per ottenere privilegi elevati non autorizzati. La concessione dell'accesso in lettura a questa directory potrebbe offrire agli utenti senza privilegi informazioni dettagliate su come ottenere privilegi elevati o aggirare i controlli di controllo. |Impostare il proprietario e il gruppo di/etc/Chron.Weekly su root e le autorizzazioni per 0700 o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Fix-cron-file-perms |
|Assicurarsi che at/cron sia limitato a utenti autorizzati<br /><sub>(98)</sub> |Descrizione: in molti sistemi, solo l'amministratore di sistema è autorizzato a pianificare i `cron` processi. L'utilizzo del `cron.allow` file per controllare gli utenti che possono eseguire i `cron` processi impone questo criterio. È più semplice gestire un elenco di indirizzi consentiti rispetto a un elenco di accesso negato. In un elenco di accesso negato, è possibile aggiungere un ID utente al sistema e dimenticare di aggiungerlo ai file di negazione. |sostituire/etc/cron.Deny e/etc/at.Deny con i rispettivi `allow` file |
|Verificare che il banner di avviso di accesso remoto sia configurato correttamente.<br /><sub>(111)</sub> |Descrizione: i messaggi di avviso indicano agli utenti che tentano di accedere al sistema del rispettivo stato legale in merito al sistema e devono includere il nome dell'organizzazione che possiede il sistema e gli eventuali criteri di monitoraggio. La visualizzazione delle informazioni sul livello del sistema operativo e della patch nei banner di accesso ha anche l'effetto collaterale di fornire informazioni dettagliate sul sistema a utenti malintenzionati che tentano di utilizzare exploit specifici di un sistema. Gli utenti autorizzati possono ottenere facilmente queste informazioni eseguendo il `uname -a` comando dopo aver eseguito l'accesso. |Rimuovere tutte le istanze di \m \s e \v dal file/etc/issue.NET |
|Verificare che il banner di avviso di accesso locale sia configurato correttamente.<br /><sub>(111,1)</sub> |Descrizione: i messaggi di avviso indicano agli utenti che tentano di accedere al sistema del rispettivo stato legale in merito al sistema e devono includere il nome dell'organizzazione che possiede il sistema e gli eventuali criteri di monitoraggio. La visualizzazione delle informazioni sul livello del sistema operativo e della patch nei banner di accesso ha anche l'effetto collaterale di fornire informazioni dettagliate sul sistema a utenti malintenzionati che tentano di utilizzare exploit specifici di un sistema. Gli utenti autorizzati possono ottenere facilmente queste informazioni eseguendo il `uname -a` comando dopo aver eseguito l'accesso. |Rimuovere tutte le istanze di \m \s e \v dal file/etc/issue |
|Il servizio avahi-daemon deve essere disabilitato.<br /><sub>(114)</sub> |Descrizione: un utente malintenzionato potrebbe usare una vulnerabilità nel daemon avahi per ottenere l'accesso |Disabilitare il servizio avahi-daemon o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-avahi-daemon ' |
|Il servizio CUPS dovrebbe essere disabilitato.<br /><sub>(115)</sub> |Descrizione: un utente malintenzionato potrebbe usare un difetto nel servizio CUPS per elevare i privilegi |Disabilitare il servizio CUPS o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-cups ' |
|Il servizio ISC-dhcpd deve essere disabilitato.<br /><sub>(116)</sub> |Descrizione: un utente malintenzionato potrebbe usare dhcpd per fornire informazioni difettose ai client e interferire con il normale funzionamento. |Rimuovere il pacchetto ISC-DHCP-Server (apt-get remove ISC-DHCP-Server) |
|È necessario disinstallare il pacchetto ISC-DHCP-server.<br /><sub>(117)</sub> |Descrizione: un utente malintenzionato potrebbe usare dhcpd per fornire informazioni difettose ai client e interferire con il normale funzionamento. |Rimuovere il pacchetto ISC-DHCP-Server (apt-get remove ISC-DHCP-Server) |
|Il pacchetto sendmail deve essere disinstallato.<br /><sub>(120)</sub> |Descrizione: un utente malintenzionato potrebbe usare questo sistema per inviare messaggi di posta elettronica con contenuti dannosi ad altri utenti |Disinstallare il pacchetto sendmail (apt-get remove sendmail) |
|Il pacchetto suffisso deve essere disinstallato.<br /><sub>(121)</sub> |Descrizione: un utente malintenzionato potrebbe usare questo sistema per inviare messaggi di posta elettronica con contenuti dannosi ad altri utenti |Disinstallare il pacchetto suffisso (apt-get suffisso Remove) o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Remove-Postfix ' |
|L'ascolto di rete suffisso deve essere disabilitato nel modo appropriato.<br /><sub>(122)</sub> |Descrizione: un utente malintenzionato potrebbe usare questo sistema per inviare messaggi di posta elettronica con contenuti dannosi ad altri utenti |Aggiungere la riga ' inet_interfaces localhost ' al file '/etc/postfix/main.cf ' |
|Il servizio LDAP deve essere disabilitato.<br /><sub>(124)</sub> |Descrizione: un utente malintenzionato potrebbe modificare il servizio LDAP in questo host per distribuire i dati falsi ai client LDAP |Disinstallare il pacchetto slapd (apt-get remove slapd) |
|Il servizio rpcgssd deve essere disabilitato.<br /><sub>(126)</sub> |Descrizione: un utente malintenzionato potrebbe usare un difetto in rpcgssd/NFS per ottenere l'accesso |Disabilitare il servizio rpcgssd o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcgssd ' |
|Il servizio rpcidmapd deve essere disabilitato.<br /><sub>(127)</sub> |Descrizione: un utente malintenzionato potrebbe usare un difetto in idmapd/NFS per ottenere l'accesso |Disabilitare il servizio rpcidmapd o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcidmapd ' |
|Il servizio portmap deve essere disabilitato.<br /><sub>(129)</sub> |Descrizione: un utente malintenzionato potrebbe usare un difetto in portmap per ottenere l'accesso |Disabilitare il servizio rpcbind o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rpcbind ' |
|Il servizio rpcsvcgssd deve essere disabilitato.<br /><sub>(130)</sub> |Descrizione: un utente malintenzionato potrebbe usare un difetto in rpcsvcgssd per ottenere l'accesso |Rimuovere la riga ' NEED_SVCGSSD = Yes ' dal file '/etc/inetd.conf ' |
|Il servizio denominato deve essere disabilitato.<br /><sub>(131)</sub> |Descrizione: un utente malintenzionato potrebbe usare il servizio DNS per distribuire i dati falsi ai client |Disinstallare il pacchetto bind9 (apt-get remove bind9) |
|È necessario disinstallare il pacchetto di binding.<br /><sub>(132)</sub> |Descrizione: un utente malintenzionato potrebbe usare il servizio DNS per distribuire i dati falsi ai client |Disinstallare il pacchetto bind9 (apt-get remove bind9) |
|Il servizio Colombaia dovrebbe essere disabilitato.<br /><sub>(137)</sub> |Descrizione: il sistema può essere usato come server IMAP/POP3 |Disinstallare il pacchetto Colombaia-Core (apt-get remove Colombaia-Core) |
|Il pacchetto Colombaia deve essere disinstallato.<br /><sub>(138)</sub> |Descrizione: il sistema può essere usato come server IMAP/POP3 |Disinstallare il pacchetto Colombaia-Core (apt-get remove Colombaia-Core) |
|Assicurarsi che non `+` esistano voci legacy in/etc/passwd<br /><sub>(156,1)</sub> |Descrizione: un utente malintenzionato potrebbe ottenere l'accesso usando il nome utente ' +' senza password |Rimuovere tutte le voci in/etc/passwd che iniziano con ' +:' |
|Assicurarsi che non `+` esistano voci legacy in/etc/shadow<br /><sub>(156,2)</sub> |Descrizione: un utente malintenzionato potrebbe ottenere l'accesso usando il nome utente ' +' senza password |Rimuovere tutte le voci in/etc/shadow che iniziano con ' +:' |
|Assicurarsi che non `+` esistano voci legacy in/etc/Group<br /><sub>(156,3)</sub> |Descrizione: un utente malintenzionato potrebbe ottenere l'accesso usando il nome utente ' +' senza password |Rimuovere tutte le voci in/etc/group che iniziano con ' +:' |
|Verificare che la scadenza della password sia pari a 365 giorni.<br /><sub>(157,1)</sub> |Descrizione: la finestra di opportunità per un utente malintenzionato di sfruttare le credenziali compromesse o di compromettere correttamente le credenziali tramite un attacco di forza bruta online è limitata dall'età della password. Pertanto, la riduzione della durata massima di una password riduce anche la finestra di opportunità di un utente malintenzionato. |Impostare il `PASS_MAX_DAYS` parametro su non più di 365 in `/etc/login.defs`  o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Configure-password-policy-max-Days ' |
|Verificare che i giorni di avviso per la scadenza della password siano 7 o più.<br /><sub>(157,2)</sub> |Descrizione: se si invia un avviso preliminare per la scadenza di una password, gli utenti possono pensare a una password sicura. Gli utenti rilevati possono scegliere una password semplice o annotare il punto in cui può essere individuata. |Impostare il `PASS_WARN_AGE` parametro su 7 in `/etc/login.defs`  o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Configure-password-policy-warn-Age ' |
|Verificare che il riutilizzo delle password sia limitato.<br /><sub>(157,5)</sub> |Descrizione: la forzatura degli utenti a non riutilizzare le ultime 5 password rende meno probabile che un utente malintenzionato possa indovinare la password. |Verificare che l'opzione ' ricorda ' sia impostata su almeno 5 in/etc/pam.d/common-password o/etc/pam.d/password_auth e/etc/pam.d/system_auth oppure eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Configure-password-policy-History ' |
|Verificare che l'algoritmo di hashing delle password sia SHA-512<br /><sub>(157,11)</sub> |Descrizione: l'algoritmo SHA-512 fornisce un hashing molto più potente rispetto a MD5, garantendo in tal modo una protezione aggiuntiva al sistema aumentando il livello di lavoro richiesto da un utente malintenzionato per determinare correttamente le password. Nota: queste modifiche si applicano solo agli account configurati nel sistema locale. |Impostare algoritmo di hashing delle password su SHA512. Molte distribuzioni forniscono gli strumenti per aggiornare la configurazione di PAM. per informazioni dettagliate, vedere la documentazione. Se non viene fornito alcun strumento, modificare il `/etc/pam.d/` file di configurazione appropriato e aggiungere o modificare le `pam_unix.so` righe in modo da includere l'opzione SHA512: ``` password sufficient pam_unix.so sha512 ``` |
|Verificare che il numero minimo di giorni tra le modifiche della password sia 7 o superiore.<br /><sub>(157,12)</sub> |Descrizione: limitando la frequenza delle modifiche della password, un amministratore può impedire agli utenti di modificare ripetutamente la password nel tentativo di aggirare i controlli di riutilizzo delle password. |Impostare il `PASS_MIN_DAYS` parametro su 7 in `/etc/login.defs` : `PASS_MIN_DAYS 7` . Modificare i parametri utente per tutti gli utenti con una password impostata in modo che corrisponda a: `chage --mindays 7`  o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r set-pass-min-Days ' |
|Verificare che la data dell'Ultima modifica della password per tutti gli utenti sia nel passato<br /><sub>(157,14)</sub> |Descrizione: se una data di modifica della password registrata dagli utenti è in futuro, è possibile ignorare qualsiasi scadenza del set di password. |Verificare che il blocco di password inattivo sia di 30 giorni o meno, eseguire il comando seguente per impostare il periodo di inattività della password predefinito su 30 giorni: ``` # useradd -D -f 30 ``` modificare i parametri utente per tutti gli utenti con una password impostata per la corrispondenza: ``` # chage --inactive 30  ``` |
|Verificare che gli account di sistema non siano account di accesso<br /><sub>(157,15)</sub> |Descrizione: è importante assicurarsi che gli account che non sono usati dagli utenti normali non vengano usati per fornire una shell interattiva. Per impostazione predefinita, Ubuntu imposta il campo password per questi account su una stringa non valida, ma è anche consigliabile che il campo della shell nel file di password sia impostato su `/usr/sbin/nologin` . In questo modo si impedisce che l'account venga usato potenzialmente per eseguire qualsiasi comando. |Impostare la Shell per tutti gli account restituiti dallo script di controllo su `/sbin/nologin` |
|Verificare che il gruppo predefinito per l'account radice sia GID 0<br /><sub>(157,16)</sub> |Descrizione: l'utilizzo di GID 0 per l' `_root_ ` account consente di impedire `_root_` che i file di proprietà possano essere accidentalmente accessibili a utenti senza privilegi. |Eseguire il comando seguente per impostare il `root` gruppo predefinito utente su GID `0` : ``` # usermod -g 0 root ``` |
|Verificare che la radice sia l'unico account UID 0<br /><sub>(157,18)</sub> |Descrizione: questo accesso deve essere limitato solo all'account predefinito `root ` e solo dalla console di sistema. L'accesso amministrativo deve essere tramite un account senza privilegi utilizzando un meccanismo approvato. |Rimuovere eventuali utenti diversi da `root` UID `0` o assegnare loro un nuovo UID, se appropriato. |
|Rimuovere i pacchetti non necessari<br /><sub>(158)</sub> |Descrizione:  |Eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Remove-Landscape-Common |
|Rimuovere gli account non necessari<br /><sub>(159)</sub> |Descrizione: per conformità |Rimuovere gli account non necessari |
|Verificare che il servizio controllato sia abilitato<br /><sub>(162)</sub> |Descrizione: l'acquisizione di eventi di sistema fornisce agli amministratori di sistema le informazioni che consentono di determinare se si sta verificando l'accesso non autorizzato al sistema. |Installare il pacchetto di controllo (systemctl enable auditd) |
|Esegui servizio controllato<br /><sub>(163)</sub> |Descrizione: l'acquisizione di eventi di sistema fornisce agli amministratori di sistema le informazioni che consentono di determinare se si sta verificando l'accesso non autorizzato al sistema. |Esegui servizio controllato (systemctl Start auditd) |
|Verificare che il server SNMP non sia abilitato<br /><sub>(179)</sub> |Descrizione: il server SNMP è in grado di comunicare utilizzando SNMP v1, che trasmette i dati in chiaro e non richiede l'autenticazione per l'esecuzione di comandi. A meno che non sia assolutamente necessario, è consigliabile non usare il servizio SNMP. Se SNMP è necessario, il server deve essere configurato in modo da non consentire SNMP v1. |Eseguire uno dei comandi seguenti per disabilitare `snmpd` : ``` # chkconfig snmpd off ``` ``` # systemctl disable snmpd `````` # update-rc.d snmpd disable ``` |
|Verificare che il servizio rsync non sia abilitato<br /><sub>(181)</sub> |Descrizione: il `rsyncd` servizio presenta un rischio per la sicurezza perché usa protocolli non crittografati per la comunicazione. |Eseguire uno dei comandi seguenti per disabilitare `rsyncd` : `chkconfig rsyncd off` , `systemctl disable rsyncd` `update-rc.d rsyncd disable` o eseguire '/opt/Microsoft/omsagent/plugin/omsremediate-r Disable-rsysnc ' |
|Verificare che il server NIS non sia abilitato<br /><sub>(182)</sub> |Descrizione: il servizio NIS è intrinsecamente un sistema non sicuro vulnerabile ad attacchi DOS, overflow del buffer e con autenticazione insufficiente per l'esecuzione di query sulle mappe NIS. In genere, NIS è stato sostituito da protocolli come Lightweight Directory Access Protocol (LDAP). È consigliabile disabilitare il servizio e altri servizi più sicuri |Eseguire uno dei comandi seguenti per disabilitare `ypserv` : ``` # chkconfig ypserv off ``` ``` # systemctl disable ypserv `````` # update-rc.d ypserv disable ``` |
|Verificare che il client rsh non sia installato<br /><sub>(183)</sub> |Descrizione: questi client legacy contengono numerose esposizioni di sicurezza e sono stati sostituiti con il pacchetto SSH più sicuro. Anche se il server viene rimosso, è preferibile assicurarsi che i client vengano rimossi anche per impedire agli utenti di provare inavvertitamente a usare questi comandi, esponendo quindi le proprie credenziali. Si noti che la rimozione del `rsh ` pacchetto consente di rimuovere i client per `rsh` , `rcp ` e `rlogin` . |Disinstallare `rsh` utilizzando il gestore pacchetti appropriato o l'installazione manuale: ``` yum remove rsh ``` ``` apt-get remove rsh `````` zypper remove rsh ``` |
|Disabilitare SMB v1 con Samba<br /><sub>(185)</sub> |Descrizione: SMB v1 presenta vulnerabilità ben note e gravi e non crittografa i dati in transito. Se deve essere utilizzato per la sostituzione di motivi aziendali, è consigliabile identificare altre mitigazioni per compensare l'utilizzo di questo protocollo.  |Se Samba non è in esecuzione, rimuovere il pacchetto. in caso contrario, dovrebbe essere presente una riga nella sezione [Global] di/etc/samba/smb.conf: min Protocol = SMB2 o Run '/opt/Microsoft/omsagent/plugin/omsremediate-r set-SMB-min-Version |

> [!NOTE]
> La disponibilità delle impostazioni di configurazione Guest di criteri di Azure specifiche può variare in Azure per enti pubblici e in altri cloud nazionali.

## <a name="next-steps"></a>Passaggi successivi

Articoli aggiuntivi sui criteri di Azure e sulla configurazione Guest:

- [Configurazione Guest di criteri di Azure](../concepts/guest-configuration.md).
- Panoramica della [Conformità con le normative](../concepts/regulatory-compliance.md).
- Vedere altri esempi in [Esempi di Criteri di Azure](./index.md).
- Leggere [Informazioni sugli effetti di Criteri](../concepts/effects.md).
- Informazioni su come [correggere le risorse non conformi](../how-to/remediate-resources.md).
