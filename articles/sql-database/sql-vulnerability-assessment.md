---
title: Valutazione della vulnerabilità SQL
description: Informazioni su come configurare la valutazione della vulnerabilità SQL nel database SQL di Azure e interpretare i report di valutazione.
services: sql-database
ms.service: sql-database
ms.subservice: security
ms.custom: ''
ms.devlang: ''
ms.topic: conceptual
author: mibar
ms.author: mibar
ms.reviewer: vanto, carlrab
ms.date: 04/19/2020
tags: azure-synapse
ms.openlocfilehash: 80629898b56f81fc738cb30df63766ea39adea6d
ms.sourcegitcommit: 849bb1729b89d075eed579aa36395bf4d29f3bd9
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/28/2020
ms.locfileid: "81684261"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>La valutazione della vulnerabilità di SQL consente di identificare le vulnerabilità del database

La valutazione della vulnerabilità di SQL è un servizio facile da configurare che consente di individuare, monitorare e risolvere potenziali vulnerabilità del database. È consigliabile usarlo in modo proattivo per migliorare la sicurezza dei database.

La valutazione della vulnerabilità fa parte dell'offerta [avanzata di sicurezza dei dati](sql-database-advanced-data-security.md) , un pacchetto unificato per le funzionalità avanzate di sicurezza di SQL. È possibile accedere e gestire la valutazione della vulnerabilità tramite il portale SQL Advanced Data Security centrale.

> [!NOTE]
> La valutazione della vulnerabilità è supportata per il database SQL di Azure, istanza gestita di database SQL di Azure e l'analisi delle sinapsi di Azure. Per praticità, in questo articolo viene usato il database SQL per fare riferimento a uno qualsiasi di questi servizi di database gestiti.

## <a name="vulnerability-assessment"></a>Valutazione della vulnerabilità

La valutazione della vulnerabilità di SQL è un servizio che offre visibilità sullo stato di sicurezza. La valutazione della vulnerabilità include passaggi utilizzabili per risolvere i problemi di sicurezza e migliorare la sicurezza del database. Può essere utile per: 

- Soddisfare i requisiti di conformità che richiedono report di analisi dei database.
- Soddisfare gli standard per la privacy dei dati.
- Monitorare un ambiente di database dinamico in cui è difficile tenere traccia delle modifiche.

La valutazione della vulnerabilità è un servizio di analisi integrato nel database SQL di Azure. Il servizio usa una Knowledge base di regole che contrassegnano le vulnerabilità della sicurezza. Evidenzia le deviazioni dalle procedure consigliate, ad esempio configurazioni errate, autorizzazioni eccessive e dati sensibili non protetti.

Le regole sono basate sulle procedure consigliate di Microsoft e si concentrano sui problemi di sicurezza che presentano i maggiori rischi per il database e i relativi dati importanti. Si tratta di problemi a livello di database e di sicurezza a livello di server, ad esempio le impostazioni del firewall del server e le autorizzazioni a livello di server. Queste regole rappresentano anche molti dei requisiti specificati da vari organismi normativi per soddisfare i relativi standard di conformità.

I risultati dell'analisi includono le azioni applicabili per risolvere ogni problema, oltre a script di correzione personalizzati, ove applicabile. È possibile personalizzare un report di valutazione per l'ambiente impostando una baseline accettabile per:
* Configurazioni delle autorizzazioni.
* Configurazioni delle funzionalità.
* Impostazioni del database.

## <a name="implement-vulnerability-assessment"></a>Implementare la valutazione della vulnerabilità

I passaggi seguenti implementano la valutazione della vulnerabilità nel database SQL.

### <a name="1-run-a-scan"></a>1. eseguire un'analisi

Nel riquadro database SQL di Azure, sotto l'intestazione **sicurezza** , selezionare **sicurezza avanzata dei dati**. Fare quindi clic su **Seleziona archiviazione** nel riquadro **valutazione della vulnerabilità** per aprire il riquadro impostazioni di valutazione della vulnerabilità per l'intero server SQL.

Configurare un account di archiviazione in cui verranno archiviati i risultati dell'analisi per tutti i database nel server. Per altre informazioni sugli account di archiviazione, vedere [Informazioni sugli account di archiviazione di Azure](../storage/common/storage-create-storage-account.md). Dopo aver configurato l'archiviazione, selezionare **Scan** per analizzare le vulnerabilità del database.

![Eseguire l'analisi di un database](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > L'analisi è un'operazione leggera e sicura, Sono necessari alcuni secondi per l'esecuzione ed è interamente di sola lettura. Non viene apportata alcuna modifica al database.

### <a name="2-view-the-report"></a>2. Visualizzare il report

Al termine dell'analisi, il report di analisi viene visualizzato automaticamente nel portale di Azure. Il report presenta una panoramica dello stato di sicurezza. Elenca il numero di problemi trovati e i rispettivi livelli di gravità. I risultati includono avvisi sulle deviazioni dalle procedure consigliate e uno snapshot delle impostazioni relative alla sicurezza, ad esempio le entità di database e i ruoli e le autorizzazioni associate. Il report di analisi fornisce anche una mappa dei dati sensibili individuati nel database. Include consigli per classificare i dati usando l' [individuazione e la classificazione dei dati](sql-database-data-discovery-and-classification.md).

![Visualizzare il report](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. analizzare i risultati e risolvere i problemi

Esaminare i risultati e determinare quali di questi sono problemi di sicurezza reali nell'ambiente in uso. Eseguire il drill-down per ogni risultato con errore per comprendere l'impatto della ricerca e il motivo per cui i controlli di sicurezza non sono riusciti. Usare le informazioni sulle azioni di correzione applicabili incluse nel report per risolvere il problema.

![Analizzare il report](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. impostare la linea di base

Quando si esaminano i risultati della valutazione, è possibile contrassegnare risultati specifici come una *baseline* accettabile nell'ambiente in uso. La baseline è essenzialmente una personalizzazione della modalità di visualizzazione dei risultati. I risultati corrispondenti alla baseline non vengono considerati problemi nelle analisi successive. Dopo aver stabilito lo stato di sicurezza della linea di base, la valutazione della vulnerabilità segnala solo le deviazioni dalla linea di base. In questo modo, è possibile concentrare l'attenzione sui problemi rilevanti.

![Impostare la linea di base](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. eseguire una nuova analisi per visualizzare il report di rilevamento personalizzato

Al termine della configurazione delle **linee di base della regola**, eseguire una nuova analisi per visualizzare il report personalizzato. La valutazione della vulnerabilità ora segnala solo i problemi di sicurezza che deviano dallo stato di base approvato.

![Visualizzare il report personalizzato](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Il servizio Valutazione della vulnerabilità può ora essere usato per controllare che il database mantenga un livello elevato di sicurezza in qualsiasi momento e che i criteri aziendali siano soddisfatti. Se sono necessari i report di conformità, i report di valutazione della vulnerabilità possono essere utili per facilitare il processo di conformità.

### <a name="6-set-up-periodic-recurring-scans"></a>6. configurare analisi ricorrenti periodiche

Passare alle impostazioni di valutazione della vulnerabilità per attivare le **analisi ricorrenti periodiche**. Questa impostazione configura la valutazione della vulnerabilità per eseguire automaticamente un'analisi del database una volta alla settimana. Un riepilogo dei risultati di analisi viene inviato agli indirizzi di posta elettronica forniti.

![Visualizzare il report personalizzato](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. esportare un report di valutazione

Selezionare **Esporta risultati analisi** per creare un report di Excel scaricabile per il risultato dell'analisi. Questo report contiene una scheda riepilogativa che visualizza un riepilogo della valutazione. Il report include tutti i controlli non riusciti. Include inoltre una scheda **risultati** che contiene il set completo di risultati dell'analisi. I risultati includono tutti i controlli eseguiti e i relativi dettagli.

### <a name="8-view-scan-history"></a>8. visualizzare la cronologia delle analisi

Selezionare **Cronologia analisi** nel riquadro valutazione della vulnerabilità per visualizzare la cronologia di tutte le analisi eseguite in precedenza nel database. Selezionare un'analisi specifica nell'elenco per visualizzarne i risultati dettagliati.

Il servizio Valutazione della vulnerabilità può ora essere usato per controllare che il database mantenga un livello elevato di sicurezza in qualsiasi momento e che i criteri aziendali siano soddisfatti. Se sono necessari i report di conformità, i report di valutazione della vulnerabilità possono essere utili per facilitare il processo di conformità.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Gestire le valutazioni delle vulnerabilità usando Azure PowerShell

[!INCLUDE [updated-for-az](../../includes/updated-for-az.md)]
> [!IMPORTANT]
> Il modulo Azure Resource Manager di PowerShell è ancora supportato dal database SQL di Azure, ma tutte le attività di sviluppo future sono per il modulo AZ. SQL. Per questi cmdlet, vedere [AzureRM. SQL](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Gli argomenti per i comandi nel modulo AZ e nei moduli AzureRm sono sostanzialmente identici.

È possibile usare i cmdlet di Azure PowerShell per gestire a livello di codice le valutazioni delle vulnerabilità. I cmdlet supportati sono:

| Nome del cmdlet come collegamento | Descrizione |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Cancella la baseline della regola di valutazione della vulnerabilità.<br/>Prima di tutto, impostare la linea di base prima di usare questo cmdlet per cancellarla. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Cancella le impostazioni di valutazione della vulnerabilità di un database. |
| [Convert-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Converte i risultati dell'analisi della valutazione della vulnerabilità in un file di Excel. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Ottiene la baseline della regola di valutazione della vulnerabilità per una determinata regola. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Ottiene tutti i record di analisi della valutazione della vulnerabilità associati a un determinato database. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Restituisce le impostazioni di valutazione della vulnerabilità di un database. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Imposta la baseline della regola di valutazione della vulnerabilità. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Attiva l'avvio di un'analisi di valutazione della vulnerabilità. |
| [Update-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Aggiorna le impostazioni di valutazione della vulnerabilità di un database. |
| &nbsp; | &nbsp; |

Per un esempio di script, vedere [Supporto di PowerShell per la valutazione della vulnerabilità di SQL di Azure](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Gestire le regole di base della valutazione della vulnerabilità usando modelli di Gestione risorse

Per configurare le linee di base di valutazione della vulnerabilità usando Azure Resource Manager modelli `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` , usare il tipo.

Assicurarsi di aver abilitato `vulnerabilityAssessments` nel computer che esegue SQL Server prima di aggiungere le basi di riferimento.

Di seguito è riportato un esempio per la definizione della regola di base VA2065 in MasterDB e VA1143 in userdb al come risorse in un modello di Gestione risorse:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

Per il database master e il database utente, i nomi delle risorse sono definiti in modo diverso:

* Database master-"nome": "[Concat (parametri (' server_name '),'/', parametri (' database_name '),'/default/VA2065/<b>Master</b>')]",
* Database utente-"nome": "[Concat (parametri (' server_name '),'/', parametri (' database_name '),'/default/VA2065/<b>default</b>')]",
 
 
 Per gestire i tipi booleani come true/false, impostare il risultato della linea di base con input binario come "1"/"0".
 
```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Passaggi successivi  

- Altre informazioni sulla [sicurezza dei dati avanzata](sql-database-advanced-data-security.md).
- Altre informazioni sull' [individuazione e la classificazione dei dati](sql-database-data-discovery-and-classification.md).
