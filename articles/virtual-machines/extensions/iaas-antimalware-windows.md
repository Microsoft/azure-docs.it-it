---
title: Estensione Microsoft antimalware per macchine virtuali Windows in Azure
description: Distribuire l'estensione Antimalware Azure nella macchina virtuale Windows usando un'estensione.
services: virtual-machines
documentationcenter: ''
author: TerryLanfear
manager: rkarlin
editor: ''
ms.assetid: ''
ms.service: virtual-machines
ms.subservice: extensions
ms.collection: windows
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: infrastructure-services
ms.date: 02/23/2021
ms.author: terrylan
ms.openlocfilehash: db4341bf240717b48f3b2dfa6e119393be374f49
ms.sourcegitcommit: ed7376d919a66edcba3566efdee4bc3351c57eda
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/24/2021
ms.locfileid: "105042765"
---
# <a name="microsoft-antimalware-extension-for-windows"></a>Estensione Antimalware Microsoft per Windows

## <a name="overview"></a>Panoramica

L'attuale panorama delle minacce per gli ambienti cloud è estremamente dinamico e costringe i sottoscrittori di cloud IT aziendali a mantenere attiva la protezione per soddisfare i requisiti di conformità e sicurezza. Microsoft Antimalware per Azure è una funzionalità di protezione in tempo reale gratuita che consente di identificare e rimuovere virus, spyware e altro software dannoso e offre avvisi configurabili per i casi in cui software dannoso o indesiderato tenta di installarsi o eseguirsi nei sistemi Azure. La soluzione è basata sulla stessa piattaforma antimalware di Microsoft Security Essentials (MSE), Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune e Windows Defender per Windows 8.0 e versioni successive.
Microsoft Antimalware per Azure è una soluzione con un agente singolo per applicazioni e ambienti tenant, progettata per l'esecuzione in background senza intervento da parte dell'utente. È possibile distribuire la protezione in base alle esigenze dei carichi di lavoro dell'applicazione, con una configurazione sicura per impostazione predefinita o avanzata personalizzata, incluso il monitoraggio antimalware.

## <a name="prerequisites"></a>Prerequisiti

### <a name="operating-system"></a>Sistema operativo

La soluzione Microsoft Antimalware per Azure include Microsoft Antimalware Client and Service, il modello di distribuzione classico antimalware, i cmdlet di PowerShell per Antimalware e l'estensione Diagnostica di Azure. La soluzione Microsoft Antimalware è supportata nelle famiglie dei sistemi operativi Windows Server 2008 R2, Windows Server 2012 e Windows Server 2012 R2. Non è supportata nel sistema operativo Windows Server 2008 e nemmeno in Linux. 

Windows Defender è l'antimalware predefinito abilitato in Windows Server 2016. Anche l'interfaccia di Windows Defender è abilitata per impostazione predefinita su alcune SKU di Windows Server 2016.
Con Windows Defender è possibile aggiungere l'estensione dell'antimalware della macchina virtuale di Azure a una macchina virtuale di Azure con Windows Server 2016, ma in questo scenario l'estensione applicherà eventuali criteri di configurazione per l'uso da parte di Windows Defender e non distribuirà alcun servizio antimalware aggiuntivo. Altre informazioni su questo aggiornamento, sono disponibili [qui](/archive/blogs/azuresecurity/update-to-azure-antimalware-extension-for-cloud-services).

### <a name="internet-connectivity"></a>Connettività Internet

La soluzione Microsoft Antimalware per Windows richiede che la macchina virtuale di destinazione sia connessa a Internet per ricevere aggiornamenti regolari del motore e della firma. 

## <a name="template-deployment"></a>Distribuzione del modello
Le estensioni macchina virtuale di Azure possono essere distribuite con i modelli di Azure Resource Manager. I modelli rappresentano la scelta migliore quando si distribuiscono una o più macchine virtuali per cui è necessaria una configurazione post-distribuzione come l'onboarding ad Azure Antimalware.

La configurazione JSON per un'estensione macchina virtuale può essere annidata nella risorsa della macchina virtuale o posizionata nel livello radice o nel livello superiore di un modello JSON di Gestione risorse. Il posizionamento della configurazione JSON influisce sul valore del nome e del tipo di risorsa. Per altre informazioni, vedere [Set name and type for child resources](../../azure-resource-manager/templates/child-resource-name-type.md) (Impostare il nome e il tipo per le risorse figlio). 

L'esempio seguente presuppone che l'estensione macchina virtuale sia annidata all'interno della risorsa della macchina virtuale. Quando la risorsa di estensione viene nidificata, JSON viene inserito nell'oggetto `"resources": []` della macchina virtuale.

```json
{
      "type": "Microsoft.Compute/virtualMachines/extensions",
      "name": "[concat(parameters('vmName'),'/', parameters('vmExtensionName'))]",
      "apiVersion": "2019-07-01",
      "location": "[resourceGroup().location]",
      "dependsOn": [
        "[concat('Microsoft.Compute/virtualMachines/', parameters('vmName'))]"
      ],

      "properties": {
        "publisher": "Microsoft.Azure.Security",
        "type": "IaaSAntimalware",
        "typeHandlerVersion": "1.3",
        "autoUpgradeMinorVersion": true,
        "settings": {
          "AntimalwareEnabled": "true",
          "Exclusions": {
            "Extensions": ".log;.ldf",
            "Paths": "D:\\IISlogs;D:\\DatabaseLogs",
            "Processes": "mssence.svc"
          },

          "RealtimeProtectionEnabled": "true",
          "ScheduledScanSettings": {
            "isEnabled": "true",
            "scanType": "Quick",
            "day": "7",
            "time": "120"
          }
        },
        "protectedSettings": null
      }
}
```

## <a name="powershell-deployment"></a>Distribuzione PowerShell
In funzione del tipo di distribuzione, usare i comandi corrispondenti per distribuire l'estensione della macchina virtuale di Azure Antimalware in una macchina virtuale esistente.

  * [Macchina virtuale basata su Azure Resource Manager](../../security/fundamentals/antimalware-code-samples.md#enable-and-configure-microsoft-antimalware-for-azure-resource-manager-vms)
  * [Cluster di Azure Service Fabric](../../security/fundamentals/antimalware-code-samples.md#add-microsoft-antimalware-to-azure-service-fabric-clusters)
  * [Servizio cloud classico](/powershell/module/servicemanagement/azure.service/set-azureserviceextension)

## <a name="troubleshoot-and-support"></a>Risoluzione dei problemi e supporto

### <a name="troubleshoot"></a>Risolvere problemi

I log dell'estensione Microsoft Antimalware sono disponibili in - %Systemdrive%\WindowsAzure\Logs\Plugins\Microsoft.Azure.Security.IaaSAntimalware(Or PaaSAntimalware)\1.5.5.x(version#)\CommandExecution.log

### <a name="error-codes-and-their-meanings"></a>Codici di errore e relativi significati

| Codice di errore | Significato | Azione possibile |
| :---: | --- | --- |
| -2147156224 | MSI impegnato con un'altra installazione. | Provare a eseguire l'installazione in un secondo momento |
| -2147156221 | Programma di installazione MSE già in esecuzione. | Eseguire una sola istanza alla volta. |
| -2147156208 | Spazio su disco insufficiente < 200 MB. | Eliminare i file non usati quindi ripetere l'installazione. |
| -2147156187 | L'ultima installazione, aggiornamento o disinstallazione richiedeva un riavvio. | Riavviare e ripetere l'installazione. |
| -2147156121 | Il programma di installazione ha tentato di rimuovere il prodotto concorrente. La disinstallazione del prodotto concorrente non è riuscita. | Rimuovere il prodotto concorrente manualmente, riavviare il computer e ripetere l'installazione.  |
| -2147156116 | Convalida dei criteri del file non riuscita. | Verificare che all'installazione venga passato un file XML dei criteri valido.  |
| -2147156095 | Avvio del servizio Antimalware non riuscito. | Verificare che tutti i file binari siano firmati correttamente e che sia installato il file di licenza corretto. |
| -2147023293 | Errore irreversibile durante l'installazione. Si verifica nella maggior parte dei casi. EPP.msi non può registrare/avviare/arrestare il servizio antimalware o il driver del filtro ridotto. | I log MSI derivanti da EPP.msi sono necessari per esigenze di analisi future. |
| -2147023277 | Impossibile aprire il pacchetto di installazione. | Verificare che il pacchetto sia presente e, se accessibile, contattare il fornitore dell'applicazione per controllare che si tratti di un pacchetto di Windows Installer valido. |
| -2147156109 | Defender è un prerequisito necessario. |  |
| -2147205073 | L'autorità di certificazione websso non è supportata. | |
| -2147024893 | Il sistema non riesce a trovare il percorso specificato. |  |
| -2146885619 | Non è un messaggio crittografato o il messaggio crittografato non è formattato correttamente. |  |
| -1073741819 | L'istruzione in 0x%p fa riferimento alla memoria 0x%p. La memoria non può essere %s. |  |
| 1 | Funzione non corretta |  |


### <a name="support"></a>Supporto

Per ricevere assistenza in relazione a qualsiasi punto di questo articolo, contattare gli esperti di Azure nei [forum MSDN e Stack Overflow relativi ad Azure](https://azure.microsoft.com/support/forums/). In alternativa, è possibile archiviare un evento imprevisto di supporto tecnico di Azure. Accedere al [sito del supporto tecnico di Azure](https://azure.microsoft.com/support/options/)e selezionare ottenere supporto. Per informazioni sull'uso del supporto di Azure, leggere le [Domande frequenti sul supporto di Azure](https://azure.microsoft.com/support/faq/).
