---
title: Soluzione integrata di valutazione delle vulnerabilità del Centro sicurezza per macchine virtuali di Azure
description: Installare una soluzione di valutazione della vulnerabilità nelle macchine virtuali di Azure per ottenere le raccomandazioni nel centro sicurezza di Azure che consentono di proteggere le macchine virtuali.
services: security-center
documentationcenter: na
author: memildin
manager: rkarlin
ms.service: security-center
ms.devlang: na
ms.topic: how-to
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 09/22/2020
ms.author: memildin
ms.openlocfilehash: b96c9a7693b6d0d791bb97e6fb611a84a2f1f94b
ms.sourcegitcommit: 5abc3919a6b99547f8077ce86a168524b2aca350
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/07/2020
ms.locfileid: "91812616"
---
# <a name="azure-defenders-integrated-vulnerability-assessment-solution-for-azure-virtual-machines"></a>Soluzione integrata di valutazione della vulnerabilità di Azure Defender per macchine virtuali di Azure

Un componente principale di ogni programma per la sicurezza e il rischio informatico è costituito dall'identificazione e dall'analisi delle vulnerabilità. 

Quando il Centro sicurezza individua una macchina virtuale connessa senza una soluzione di valutazione della vulnerabilità distribuita, fornisce la raccomandazione sulla sicurezza:

**È consigliabile abilitare una soluzione di valutazione della vulnerabilità nelle macchine virtuali**

Usare questa raccomandazione per distribuire la soluzione di valutazione della vulnerabilità che meglio soddisfa le proprie esigenze e budget:

- **Soluzione di valutazione della vulnerabilità integrata (con tecnologia Qualys)** : Azure Defender include l'analisi delle vulnerabilità per le macchine virtuali senza costi aggiuntivi. Non è necessaria una licenza Qualys, né un account Qualys: tutto viene gestito senza interruzioni all'interno del Centro sicurezza. Questa pagina fornisce informazioni dettagliate su questo scanner e istruzioni per la relativa distribuzione.

- **Soluzioni Bring your own License (BYOL)** : il Centro sicurezza supporta l'integrazione di strumenti di altri fornitori, ma è necessario gestire i costi di licenza, la distribuzione e la configurazione. Distribuendo lo strumento con il Centro sicurezza, si otterranno informazioni sui computer in cui manca lo strumento. Sarà anche possibile visualizzare i risultati all'interno del Centro sicurezza. Se si preferisce usare la licenza Qualys o Rapid7 privata dell'organizzazione invece della licenza Qualys inclusa in Azure Defender, vedere [come distribuire una soluzione BYOL](deploy-vulnerability-assessment-byol-vm.md).


## <a name="availability"></a>Disponibilità

|Aspetto|Dettagli|
|----|:----|
|Stato della versione:|Disponibile a livello generale|
|Prezzi:|È necessario [Azure Defender per server](defender-for-servers-introduction.md)|
|Autorizzazioni e ruoli obbligatori:|Il **proprietario della risorsa** può distribuire lo scanner<br>Il **lettore di sicurezza** può visualizzare i risultati|
|Cloud:|![Sì](./media/icons/yes-icon.png) Cloud commerciali<br>![No](./media/icons/no-icon.png) Cloud nazionali/sovrani (US Gov, governo cinese, altri governi)|
|||

## <a name="overview-of-the-integrated-vulnerability-scanner"></a>Panoramica dello scanner di vulnerabilità integrato

Lo scanner di vulnerabilità incluso nel Centro sicurezza di Azure è basato su tecnologia Qualys. Il rilevatore di Qualys è uno degli strumenti migliori per l'identificazione in tempo reale delle vulnerabilità nelle macchine virtuali di Azure. È disponibile solo con [Azure Defender per i server](defender-for-servers-introduction.md). Non è necessaria una licenza Qualys, né un account Qualys: tutto viene gestito senza interruzioni all'interno del Centro sicurezza.

### <a name="how-the-integrated-vulnerability-scanner-works"></a>Funzionamento dello scanner di vulnerabilità integrato

L'estensione dello scanner di vulnerabilità funziona nel modo seguente:

1. **Distribuisci** : il Centro sicurezza di Azure monitora i computer e fornisce consigli per distribuire l'estensione Qualys nelle macchine virtuali selezionate.

1. **Raccolta di informazioni**: l'estensione raccoglie gli artefatti e li invia per l'analisi al servizio cloud di Qualys nell'area definita.

1. Il servizio cloud **Analyze** -Qualys esegue la valutazione della vulnerabilità e invia i risultati al centro sicurezza. 

    > [!IMPORTANT]
    > Per garantire la privacy, la riservatezza e la sicurezza dei clienti, Microsoft non condivide i dettagli del cliente con Qualys. [Altre informazioni sugli standard per la privacy incorporati in Azure](https://www.microsoft.com/trust-center/privacy).

1. **Report**: i risultati sono disponibili per gli utenti nel Centro sicurezza.

[![Diagramma di flusso del processo per lo scanner di vulnerabilità incorporato del Centro sicurezza di Azure](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png)](media/built-in-vulnerability-assessment/va-vm-flow-diagram.png#lightbox)


## <a name="deploy-the-integrated-vulnerability-scanner-to-your-vms"></a>Distribuire lo scanner di vulnerabilità integrato nelle macchine virtuali

1. Dal [portale di Azure](https://azure.microsoft.com/features/azure-portal/)aprire il **Centro sicurezza**.

1. Dal menu del Centro sicurezza aprire la pagina **raccomandazioni** .

1. Selezionare la raccomandazione **per abilitare una soluzione di valutazione della vulnerabilità nelle macchine virtuali**.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png" alt-text="Raggruppamenti dei computer nella pagina di raccomandazione" lightbox="./media/deploy-vulnerability-assessment-vm/recommendation-page-machine-groupings.png":::

    Le macchine virtuali verranno visualizzate in uno o più dei seguenti gruppi:

    * **Risorse integre** : il Centro sicurezza ha rilevato una soluzione di valutazione della vulnerabilità in esecuzione in queste macchine virtuali.
    * **Risorse non integre** : un'estensione dello scanner di vulnerabilità può essere distribuita in queste macchine virtuali. 
    * **Risorse non applicabili** : queste macchine virtuali non possono avere un'estensione dello scanner di vulnerabilità distribuita. La macchina virtuale potrebbe trovarsi in questa scheda perché si tratta di un'immagine in un cluster AKS, fa parte di un set di scalabilità di macchine virtuali o non esegue uno dei sistemi operativi supportati per lo scanner di vulnerabilità integrato:

        | **Fornitore** | **Sistema operativo** | **Versioni supportate** |
        |----|----|----|
        |Microsoft|Windows|Tutti|
        |Red Hat|Enterprise Linux|5.4 +, 6, 7.0-7,8, 8.0-8.1|
        |Red Hat|CentOS|5.4 +, 6, 7.0-7,7, 8.0-8.1|
        |Red Hat|Fedora|22-31|
        |SUSE|Linux Enterprise Server (SLES)|11, 12, 15|
        |SUSE|OpenSUSE|12, 13, 15.0-15.2|
        |SUSE|Leap|42.1|
        |Oracle|Enterprise Linux|5.11, 6, 7.0-7.5|
        |Debian|Debian|7. x-10. x|
        |Ubuntu|Ubuntu|12,04 LTS, 14,04 LTS, 15. x, 16,04 LTS, 18,04 LTS, 19,10, 20,04 LTS|

1. Dall'elenco di computer non **integri selezionare quelli**per ricevere una soluzione di valutazione della vulnerabilità e selezionare Correggi.

    >[!IMPORTANT]
    > A seconda della configurazione, questo elenco può essere visualizzato in modo diverso. 
    >
    > - Se non è stato configurato uno scanner di vulnerabilità di terze parti, non verrà offerta la possibilità di distribuirlo.
    > - Se le macchine virtuali selezionate non sono protette da Azure Defender, l'opzione ASC Integrated vulnerabilità scanner non sarà disponibile.

    :::image type="content" source="./media/deploy-vulnerability-assessment-vm/recommendation-remediation-options.png" alt-text="Raggruppamenti dei computer nella pagina di raccomandazione":::

1. Scegliere l'opzione consigliata, **Distribuisci ASC Integrated vulnerabilità scanner**e **continuare**.

1. Verrà richiesta una conferma ulteriore. Selezionare **Correggi**.

    L'estensione dello scanner verrà installata in tutte le VM selezionate entro pochi minuti.
    
    L'analisi viene avviata automaticamente non appena viene completata la distribuzione dell'estensione. Le analisi vengono quindi eseguite a intervalli di quattro ore. Questo intervallo non è configurabile.

    >[!IMPORTANT]
    > Se la distribuzione non riesce in una o più macchine virtuali, assicurarsi che le macchine virtuali di destinazione siano in grado di comunicare con il servizio cloud Qualys sui due indirizzi IP seguenti (tramite la porta 443, il valore predefinito per HTTPS):
    >
    >   - 64.39.104.113-Qualys ' US data center
    >   - 154.59.121.74-Qualys ' European data center
    >
    > Se la macchina virtuale si trova in un'area di Azure europea, i relativi artefatti verranno elaborati in Qualys ' European data center. Gli artefatti per le macchine virtuali presenti altrove vengono inviati all'data center degli Stati Uniti. 


## <a name="automate-at-scale-deployments"></a>Automatizzare le distribuzioni su larga scala

> [!NOTE]
> Tutti gli strumenti descritti in questa sezione sono disponibili nel [repository della community di GitHub del Centro sicurezza](https://github.com/Azure/Azure-Security-Center/blob/master/README.md). Qui è possibile trovare gli script, le automazioni e altre risorse utili da usare per tutta la distribuzione ASC.
>
> Alcuni di questi strumenti hanno effetto solo sui nuovi computer connessi dopo l'abilitazione della distribuzione su larga scala. Altri distribuiscono anche a computer esistenti. È possibile combinare più approcci.

Di seguito sono illustrati alcuni dei modi in cui è possibile automatizzare la distribuzione su larga scala dello scanner integrato:

- **Azure Resource Manager** : questo metodo è disponibile dalla **logica di raccomandazione della vista** nel portale di Azure. Lo script di monitoraggio e aggiornamento include il modello ARM pertinente che è possibile usare per l'automazione: :::image type="content" source="./media/deploy-vulnerability-assessment-vm/deploy-at-scale-remediation-logic.png" alt-text="Raggruppamenti dei computer nella pagina di raccomandazione" lightbox="./media/deploy-vulnerability-assessment-vm/deploy-at-scale-remediation-logic.png":::
- **Criteri DeployIfNotExists** : [un criterio personalizzato](https://github.com/Azure/Azure-Security-Center/tree/master/Remediation%20scripts/Enable%20the%20built-in%20vulnerability%20assessment%20solution%20on%20virtual%20machines%20(powered%20by%20Qualys)/Azure%20Policy) per garantire che tutti i computer appena creati ricevano lo scanner. Selezionare **Distribuisci in Azure** e impostare i parametri pertinenti. È possibile assegnare questo criterio a livello di gruppi di risorse, sottoscrizioni o gruppi di gestione.
- **Script di PowerShell** : usare lo ```Update qualys-remediate-unhealthy-vms.ps1``` script per distribuire l'estensione per tutte le macchine virtuali non integre. Per eseguire l'installazione su nuove risorse, automatizzare lo script con [automazione di Azure](https://docs.microsoft.com/azure/automation/automation-intro). Lo script trova tutti i computer non integri individuati dalla raccomandazione ed esegue una chiamata Azure Resource Manager.
- App per la **logica di Azure** : creare un'app per la logica basata sull' [app di esempio](https://github.com/Azure/Azure-Security-Center/tree/master/Workflow%20automation/Install-VulnAssesmentAgent). Usare gli strumenti di [automazione dei flussi di lavoro](workflow-automation.md) del Centro sicurezza per attivare l'app per la logica per distribuire lo scanner ogni volta che viene generata **una soluzione di valutazione della vulnerabilità sulle macchine virtuali** consigliate per una risorsa.
- **API REST** : per distribuire la soluzione di valutazione della vulnerabilità integrata usando l'API REST del Centro sicurezza, effettuare una richiesta PUT per l'URL seguente e aggiungere l'ID risorsa pertinente: ```https://management.azure.com/<resourceId>/providers/Microsoft.Security/serverVulnerabilityAssessments/default?api-Version=2015-06-01-preview```



## <a name="trigger-an-on-demand-scan"></a>Attivare un'analisi su richiesta

È possibile attivare un'analisi su richiesta dalla macchina virtuale stessa, usando script o oggetti Criteri di gruppo eseguiti localmente o in remoto. In alternativa, è possibile integrarlo negli strumenti di distribuzione software al termine di un processo di distribuzione patch. 

I comandi seguenti attivano un'analisi su richiesta:

- **Macchine virtuali Windows**: ```REG ADD HKLM\SOFTWARE\Qualys\QualysAgent\ScanOnDemand\Vulnerability /v "ScanOnDemand" /t REG_DWORD /d "1" /f```
- **Macchine virtuali Linux**: ```sudo /usr/local/qualys/cloud-agent/bin/cloudagentctl.sh action=demand type=vm```

## <a name="faq---integrated-vulnerability-scanner-powered-by-qualys"></a>Domande frequenti-scanner di vulnerabilità integrato (con tecnologia Qualys)

### <a name="are-there-any-additional-charges-for-the-qualys-license"></a>Sono previsti addebiti aggiuntivi per la licenza Qualys?
No. Lo scanner incorporato è gratuito per tutti gli utenti di Azure Defender. La raccomandazione distribuisce lo scanner con le relative informazioni di licenza e configurazione. Non sono necessarie licenze aggiuntive. 

### <a name="what-prerequisites-and-permissions-are-required-to-install-the-qualys-extension"></a>Quali prerequisiti e autorizzazioni sono necessari per installare l'estensione Qualys?
Sono necessarie autorizzazioni di scrittura per tutte le macchine virtuali in cui si vuole distribuire l'estensione.

L'estensione della valutazione della vulnerabilità del Centro sicurezza di Azure (con tecnologia Qualys), come le altre estensioni, viene eseguita sulla base dell'agente Macchina virtuale di Azure. Quindi viene eseguita come host locale in Windows e come root in Linux.

Durante l'installazione, il Centro sicurezza verifica che la macchina virtuale sia in grado di comunicare con i seguenti due data center di Qualys (tramite la porta 443, il valore predefinito per HTTPS):

- 64.39.104.113-Qualys ' US data center
- 154.59.121.74-Qualys ' European data center

L'estensione non accetta attualmente alcun dettaglio di configurazione del proxy.

### <a name="can-i-remove-the-security-center-qualys-extension"></a>È possibile rimuovere l'estensione Qualys del Centro sicurezza? 
Se si vuole rimuovere le estensioni da una macchina virtuale, è possibile farlo manualmente o usando uno qualsiasi degli strumenti programmatici. 

Sarà necessario quanto segue:

* In Linux l'estensione è denominata "LinuxAgent. AzureSecurityCenter" e il nome dell'editore è "Qualys".
* In Windows, l'estensione è denominata "WindowsAgent. AzureSecurityCenter" e il nome del provider è "Qualys".

### <a name="how-does-the-extension-get-updated"></a>Come viene aggiornata l'estensione?
Come lo stesso agente Centro sicurezza di Azure e tutte le altre estensioni di Azure, gli aggiornamenti secondari dello scanner Qualys possono essere eseguiti automaticamente in background. Tutti gli agenti e le estensioni vengono testati ampiamente prima di essere distribuiti automaticamente.

### <a name="why-does-my-vm-show-as-not-applicable-in-the-recommendation"></a>Perché la macchina virtuale viene visualizzata come "non applicabile" nella raccomandazione?
La pagina dei dettagli della raccomandazione raggruppa le macchine virtuali in uno o più degli elenchi seguenti: integro, non integro e non applicabile.

Se si dispone di macchine virtuali nel gruppo di risorse non applicabile, significa che il Centro sicurezza non è in grado di distribuire l'estensione dello scanner delle vulnerabilità in tali macchine virtuali. 

La macchina virtuale potrebbe essere in questa scheda perché:

- Non è protetto da Azure Defender, come illustrato in precedenza, lo scanner di vulnerabilità incluso nel centro sicurezza di Azure è disponibile solo per i computer protetti da [Azure Defender per i server](defender-for-servers-introduction.md).

- Si tratta di un'immagine in un cluster AKS o parte di un set di scalabilità di macchine virtuali. questa estensione non supporta le macchine virtuali che sono risorse PaaS.

- Non esegue uno dei sistemi operativi supportati:

    | **Fornitore** | **Sistema operativo** | **Versioni supportate** |
    |----|----|----|
    |Microsoft|Windows|Tutti|
    |Red Hat|Enterprise Linux|5.4 +, 6, 7.0-7,8, 8.0-8.1|
    |Red Hat|CentOS|5.4 +, 6, 7.0-7,7, 8.0-8.1|
    |Red Hat|Fedora|22-31|
    |SUSE|Linux Enterprise Server (SLES)|11, 12, 15|
    |SUSE|OpenSUSE|12, 13, 15.0-15.2|
    |SUSE|Leap|42.1|
    |Oracle|Enterprise Linux|5.11, 6, 7.0-7.5|
    |Debian|Debian|7. x-10. x|
    |Ubuntu|Ubuntu|12,04 LTS, 14,04 LTS, 15. x, 16,04 LTS, 18,04 LTS, 19,10, 20,04 LTS|
    ||||

### <a name="what-is-scanned-by-the-built-in-vulnerability-scanner"></a>Che cosa viene analizzato dallo scanner di vulnerabilità incorporato?
Lo scanner è in esecuzione nella macchina virtuale e cerca le vulnerabilità della macchina stessa. Dalla macchina virtuale non è in grado di eseguire l'analisi della rete.

### <a name="does-the-scanner-integrate-with-my-existing-qualys-console"></a>Lo scanner si integra con la console Qualys esistente?
L'estensione del Centro sicurezza è uno strumento separato dallo scanner Qualys esistente. Le restrizioni di licenza indicano che può essere usato solo nel Centro sicurezza di Azure.

### <a name="microsoft-defender-advanced-threat-protection-also-includes-threat--vulnerability-management-tvm-how-is-the-security-center-vulnerability-assessment-extension-different"></a>Microsoft Defender Advanced Threat Protection include anche la gestione di minacce e vulnerabilità. Qual è la differenza tra questa soluzione e l'estensione della valutazione della vulnerabilità del Centro sicurezza?
Stiamo sviluppando attivamente un servizio di gestione delle vulnerabilità di qualità elevata con le minacce di Microsoft Defender ATP & soluzione di gestione delle vulnerabilità, incorporata in Windows.

Attualmente, l'estensione per la valutazione della vulnerabilità del Centro sicurezza di Azure è basata sulla tecnologia Qualys. L'estensione Qualys garantisce il supporto per le macchine virtuali sia Windows che Linux. L'estensione trae anche vantaggio dalla competenza di Qualys in fatto di vulnerabilità per le quali non esistono ancora elenchi CVE.

### <a name="how-quickly-will-the-scanner-identify-newly-disclosed-critical-vulnerabilities"></a>Quanto rapidamente lo scanner identificherà le vulnerabilità critiche appena divulgate?
Entro 48 ore dalla divulgazione di una vulnerabilità critica, Qualys incorpora le informazioni nell'elaborazione ed è in grado di identificare le macchine virtuali interessate.



## <a name="next-steps"></a>Passaggi successivi


> [!div class="nextstepaction"]
> [Correggere i risultati della soluzione di valutazione della vulnerabilità](remediate-vulnerability-findings-vm.md)


Il Centro sicurezza offre anche l'analisi delle vulnerabilità per:

- Database SQL: vedere [Esplorare i report di valutazione della vulnerabilità nel dashboard di valutazione della vulnerabilità](defender-for-sql-usage.md#explore-vulnerability-assessment-reports)
- Immagini di Azure Container Registry. vedere [usare Azure Defender per registri contenitori per analizzare le vulnerabilità delle immagini](defender-for-container-registries-usage.md)
